(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[13,14,15,16],{"0Owb":function(n,a,s){"use strict";function t(){return t=Object.assign||function(n){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var t in s)Object.prototype.hasOwnProperty.call(s,t)&&(n[t]=s[t])}return n},t.apply(this,arguments)}s.d(a,"a",(function(){return t}))},"2dX0":function(n,a,s){"use strict";s.d(a,"a",(function(){return p}));var t=s("q1tI");function p(n,a){var s=Object(t["useRef"])(()=>{throw new Error("Cannot call function while rendering")});s.current=n;var p=Object(t["useMemo"])(()=>{var n=function(){return s.current(...arguments)};return a?a(n):n},[]),e=Object(t["useCallback"])(p,[s]);return e}},"32Fv":function(n,a,s){"use strict";s.r(a);var t=s("tJVT"),p=s("q1tI"),e=s.n(p),o=s("34YR");function c(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1500,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2?arguments[2]:void 0;return function(){return new Promise((t,p)=>{setTimeout(()=>{a?t(s||n):p(s||n)},n)})}}var l=()=>{var n=Object(p["useState"])(0),a=Object(t["a"])(n,2),s=a[0],l=a[1],u=Object(p["useState"])(!1),r=Object(t["a"])(u,2),k=r[0],i=r[1],m=Object(p["useState"])(!1),g=Object(t["a"])(m,2),d=g[0],x=g[1],E=Object(p["useState"])(!1),b=Object(t["a"])(E,2),y=b[0],v=b[1],f=Object(o["a"])(c(d?5e3:1e3,!k,{name:"lxj",bd:"1994-08",timer:Date.now()}),{initPayload:{score:Math.random().toFixed(2)},deps:[s],timeout:3e3,pollingInterval:y?2e3:0,cacheKey:"USEFETCHCHACHEKEY"}),C=f.data,N=f.loading,h=f.error,w=f.timeout,j=f.send,S=f.payload,O=f.cancel,F=e.a.createElement("span",{onClick:j,style:{color:"#1561c4",fontSize:14}},"\u91cd\u8bd5");return e.a.createElement("div",null,e.a.createElement("div",{style:{marginBottom:12}},e.a.createElement("button",{onClick:j},"\u901a\u8fc7send\u8fdb\u884c\u66f4\u65b0"),e.a.createElement("button",{onClick:()=>j({score:Math.random().toFixed(2)})},"send\u4f20\u5165payload\u8fdb\u884c\u66f4\u65b0"),e.a.createElement("button",{onClick:()=>l(n=>n+1)},"\u901a\u8fc7\u6539\u53d8deps\u66f4\u65b0 ",s)),e.a.createElement("div",{style:{marginBottom:12}},e.a.createElement("button",{onClick:()=>i(n=>!n)},"\u4e0b\u6b21\u4e3a\u9519\u8bef\u8bf7\u6c42 ",k.toString()),e.a.createElement("button",{onClick:()=>x(n=>!n)},"\u4e0b\u6b21\u4e3a\u8d85\u65f6\u8bf7\u6c42 ",d.toString())),e.a.createElement("div",{style:{marginBottom:24}},e.a.createElement("button",{onClick:()=>v(n=>!n)},"\u8f6e\u8be2\u5f00\u5173 ",y.toString()),e.a.createElement("button",{onClick:O},"\u53d6\u6d88\u8be5\u6b21\u8bf7\u6c42")),e.a.createElement("div",null,e.a.createElement("strong",null,"data:")," ",e.a.createElement("div",null,JSON.stringify(C,null,4))),e.a.createElement("div",null,e.a.createElement("strong",null,"loading:")," ",N&&e.a.createElement("span",null,"\u23f1loading...")),e.a.createElement("div",null,e.a.createElement("strong",null,"error:"),h&&e.a.createElement("div",null,JSON.stringify(h)," ",F)),e.a.createElement("div",null,e.a.createElement("strong",null,"timeout:")," ",w&&e.a.createElement("span",null,"timeout",F)),e.a.createElement("div",null,e.a.createElement("strong",null,"payload"),e.a.createElement("span",{style:{fontSize:14}},"(\u4f5c\u4e3a\u53c2\u6570\u4f20\u7ed9\u8bf7\u6c42\u65b9\u6cd5)"),":",JSON.stringify(S)),e.a.createElement("p",{style:{fontSize:14,color:"rgba(0,0,0,0.45)"}},'* \u5f53\u4f20\u5165\u4e86 cacheKey \u540e\uff0c\u4f1a\u81ea\u52a8\u5f00\u542fSWR(stale-while-revalidate)\uff0c\u5f53arg\u3001data\u3001payload\u53d1\u751f\u53d8\u66f4\u65f6\u4f1a\u5c06\u5176\u7f13\u5b58\u5230session\u4e2d\uff0c \u4e0b\u6b21\u7ec4\u4ef6\u521d\u59cb\u5316\u65f6\uff0c\u4f1a\u5148\u8bfb\u53d6\u7f13\u5b58\u6570\u636e\u8fdb\u884c\u8fd4\u56de\uff0c\u7136\u540e\u518d\u53d1\u8d77\u66f4\u65b0\u8bf7\u6c42\u5e76\u66ff\u6362\u6389"stale"\u7684\u6570\u636e\uff0c',e.a.createElement("span",{style:{color:"rgba(0,0,0,0.75)"}},"\u5237\u65b0\u9875\u9762\u5e76\u67e5\u770bdata\u7684\u53d8\u5316\u6765\u67e5\u770bSWR\u7684\u6548\u679c")),e.a.createElement("p",{style:{fontSize:14,color:"rgba(0,0,0,0.45)"}},"* \u7ade\u6001?, \u4e0e\u901a\u5e38\u610f\u4e49\u4e0a\u7684\u7ade\u6001\u7a0d\u6709\u4e0d\u540c\uff08Promise.race\u7b49\uff09\uff0c\u4f7f\u7528useFetch\u65f6\uff0c\u540e\u53d1\u8d77\u7684\u8bf7\u6c42\u4f1a\u8986\u76d6\u6389\u5148\u53d1\u8d77\u7684\u8bf7\u6c42, \u5373\u4f7f\u8be5\u8bf7\u6c42\u53d1\u751f\u4e86\u9519\u8bef\u6216\u5176\u4ed6\u5f02\u5e38"))};a["default"]=l},"34YR":function(n,a,s){"use strict";s.d(a,"a",(function(){return f}));var t=s("WmNS"),p=s.n(t),e=s("k1fw"),o=s("9og8"),c=s("tJVT"),l=s("K3qG"),u=s("sEfC"),r=s.n(u),k=s("DzJC"),i=s.n(k),m=s("q1tI"),g=s("W3VL"),d=s("4H9c"),x=s("xQ7e"),E=s("d3U/"),b=s("2dX0"),y=l["a"];function v(n){return!!n&&!!(Object(l["h"])(n)&&"nativeEvent"in n&&"target"in n&&"type"in n)}function f(n){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=Object(g["a"])({fetchID:0,fetchCount:0,timeoutTimer:0,lastFetch:Date.now()}),t=a.initData,u=a.initPayload,k=a.deps,f=void 0===k?[]:k,C=a.param,N=a.manual,h=void 0!==N&&N,w=a.timeout,j=void 0===w?1e4:w,S=a.onSuccess,O=a.onError,F=a.onComplete,P=a.onTimeout,T=a.cacheKey,D=a.stale,I=void 0===D||D,J=a.throttleInterval,R=a.debounceInterval,z=a.pollingInterval,B=!!T,U=Object(d["a"])({loading:!h&&Object(l["f"])(n),error:void 0,timeout:!1}),q=Object(c["a"])(U,2),_=q[0],K=q[1];Object(m["useEffect"])(()=>()=>{s.fetchID=0,s.timeoutTimer&&y.clearTimeout(s.timeoutTimer)},[]);var H=Object(x["a"])("".concat(T,"_FETCH_PAYLOAD"),u,{disabled:!B}),W=Object(c["a"])(H,2),A=W[0],M=W[1],Y=Object(x["a"])("".concat(T,"_FETCH_DATA"),t,{disabled:!B}),V=Object(c["a"])(Y,2),G=V[0],L=V[1],X=Object(m["useState"])(!0),$=Object(c["a"])(X,2),Q=$[0],Z=$[1],nn=Object(b["a"])(function(){var a=Object(o["a"])(p.a.mark((function a(t){var o,c,u,r,k,i=arguments;return p.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(o=i.length>1&&void 0!==i[1]&&i[1],c=Object(l["f"])(n),c){a.next=4;break}return a.abrupt("return");case 4:return s.lastFetch=Date.now(),u=Math.random(),s.fetchID=u,s.timeoutTimer&&y.clearTimeout(s.timeoutTimer),s.timeoutTimer=y.setTimeout(()=>{pn(),null===P||void 0===P||P(),K(Object(e["a"])({},tn("timeout",!0)))},j),r=s.timeoutTimer,_.loading||K(Object(e["a"])({},tn("loading",!0))),a.prev=11,a.next=14,n(t);case 14:if(k=a.sent,u===s.fetchID){a.next=17;break}return a.abrupt("return");case 17:return K(Object(e["a"])({},tn("loading",!1))),L(k),null===S||void 0===S||S(k,o),a.abrupt("return",[void 0,k]);case 23:if(a.prev=23,a.t0=a["catch"](11),u===s.fetchID){a.next=27;break}return a.abrupt("return");case 27:return K(Object(e["a"])({},tn("error",a.t0))),null===O||void 0===O||O(a.t0),a.abrupt("return",[a.t0,void 0]);case 30:if(a.prev=30,r&&y.clearTimeout(r),u===s.fetchID){a.next=34;break}return a.abrupt("return");case 34:return null===F||void 0===F||F(),s.fetchCount++,a.finish(30);case 37:case"end":return a.stop()}}),a,null,[[11,23,30,37]])})));function t(n){return a.apply(this,arguments)}return t}(),n=>J?i()(n,J,{trailing:!1}):R?r()(n,R):n),an=Object(b["a"])(n=>{var a=v(n)||void 0===n;return nn(sn(n),a)});function sn(n){return"param"in a?C:v(n)||void 0===n?A:(M(n),n)}function tn(n,a){var s={loading:!1,error:void 0,timeout:!1};return n&&(s[n]=a),s}function pn(){s.fetchID=0,s.timeoutTimer&&y.clearTimeout(s.timeoutTimer),K({loading:!1})}return Object(E["a"])(()=>{"param"in a&&(0===s.fetchCount||h||nn(sn(),!1))},[C]),Object(m["useEffect"])(()=>{h||(I||0!==s.fetchCount||Object(l["e"])(G)?nn(sn(),0!==s.fetchCount):K({loading:!1}))},[...f]),Object(m["useEffect"])((function(){var n;return Q&&z&&z>500&&(n=y.setInterval(()=>{var n=Date.now(),a=s.lastFetch,t=n-a>=z;t&&an()},z)),()=>{n&&clearInterval(n)}}),[z,Q]),Object(e["a"])({},_,{send:an,data:G,payload:A,param:C,setData:L,cancel:pn,polling:Q,setPolling:Z})}},"4H9c":function(n,a,s){"use strict";s.d(a,"a",(function(){return e}));var t=s("tJVT"),p=s("q1tI"),e=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=Object(p["useState"])(0),s=Object(t["a"])(a,2),e=s[1],o=Object(p["useState"])(n),c=Object(t["a"])(o,2),l=c[0],u=c[1],r=Object(p["useCallback"])(n=>{u(Object.assign(l,n instanceof Function?n(l):n)),e(n=>n+1)},[u]);return[l,r]}},AGUe:function(n,a,s){"use strict";s.r(a);var t=s("q1tI"),p=s.n(t),e=s("34YR");function o(n){return new Promise(a=>{setTimeout(()=>{a({code:0,msg:"\u60a8\u8f93\u5165\u7684\u503c\u662f: ".concat(n)})},300)})}var c=()=>{var n=Object(e["a"])(o,{throttleInterval:1e3,manual:!0}),a=n.data,s=n.loading,t=n.send,c=Object(e["a"])(o,{debounceInterval:300,manual:!0}),l=c.data,u=c.loading,r=c.send;return p.a.createElement("div",null,p.a.createElement("h3",null,"throttle"),p.a.createElement("p",{style:{fontSize:12}},"1s\u5185\u53ea\u4f1a\u6267\u884c\u4e00\u6b21\u8bf7\u6c42"),p.a.createElement("div",null,"\u8f93\u5165\u5173\u952e\u8bcd",p.a.createElement("input",{type:"text",onChange:n=>{var a=n.target;return t(a.value)}}),s&&"loading...",p.a.createElement("p",null,a&&JSON.stringify(a))),p.a.createElement("h3",null,"debounce"),p.a.createElement("p",{style:{fontSize:12}},"\u505c\u6b62\u8f93\u5165300ms\u540e\u89e6\u53d1\u8bf7\u6c42"),p.a.createElement("div",null,"\u8f93\u5165\u5173\u952e\u8bcd",p.a.createElement("input",{type:"text",onChange:n=>{var a=n.target;return r(a.value)}}),u&&"loading...",p.a.createElement("p",null,l&&JSON.stringify(l))))};a["default"]=c},W3VL:function(n,a,s){"use strict";s.d(a,"a",(function(){return p}));var t=s("q1tI");function p(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=Object(t["useRef"])(n);return a.current}},bnTo:function(n,a,s){"use strict";s.r(a);var t=s("tJVT"),p=s("q1tI"),e=s.n(p),o=s("34YR");function c(n){return new Promise(a=>{setTimeout(()=>{a({code:0,data:n})},500)})}var l=()=>{var n=Object(p["useState"])(1),a=Object(t["a"])(n,2),s=a[0],l=a[1],u=Object(o["a"])(c,{param:{name:"lxj",id:s}}),r=u.data,k=u.loading,i=u.param;return e.a.createElement("div",null,e.a.createElement("h3",null,"ParamDemo ",k&&"loading..."),e.a.createElement("div",{style:{marginBottom:16}},e.a.createElement("button",{onClick:()=>l(n=>n+1)},"change id ",s)),e.a.createElement("div",null,e.a.createElement("strong",null,"current param:")," ",JSON.stringify(i)),e.a.createElement("div",null,e.a.createElement("strong",null,"data"),e.a.createElement("span",{style:{fontSize:14}},"(\u8fd4\u56de\u8bf7\u6c42\u65f6\u7684\u53c2\u6570):")," ",JSON.stringify(r)))};a["default"]=l},"d3U/":function(n,a,s){"use strict";s.d(a,"a",(function(){return c}));var t=s("q1tI"),p=s("tLXD"),e=s("tq0P"),o=s.n(e);function c(n,a,s){var e=Object(p["a"])(a),c=Object(t["useRef"])(0),l=o()(a,e,s);l||c.current++,Object(t["useEffect"])(n,[c.current])}},wTlT:function(n,a,s){"use strict";s.r(a);var t=s("0Owb"),p=s("55Ip"),e=s("q1tI"),o=s.n(e),c=(s("B2uJ"),s("5Yjd")),l=s.n(c),u=o.a.memo((function(){var n=t(s("q1tI")),a=t(s("32Fv"));function t(n){return n&&n.__esModule?n:{default:n}}var p=function(){return n["default"].createElement(a["default"],null)};return n["default"].createElement(p)})),r=o.a.memo((function(){var n=t(s("q1tI")),a=t(s("AGUe"));function t(n){return n&&n.__esModule?n:{default:n}}var p=function(){return n["default"].createElement(a["default"],null)};return n["default"].createElement(p)})),k=o.a.memo((function(){var n=t(s("q1tI")),a=t(s("bnTo"));function t(n){return n&&n.__esModule?n:{default:n}}var p=function(){return n["default"].createElement(a["default"],null)};return n["default"].createElement(p)}));a["default"]=function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"markdown"},o.a.createElement("h1",{id:"usefetch"},o.a.createElement("a",{"aria-hidden":"true",href:"#usefetch"},o.a.createElement("span",{className:"icon icon-link"})),"useFetch"),o.a.createElement("p",null,"\u901a\u8fc7\u66f4",o.a.createElement("code",null,"hook"),"\u7684\u65b9\u5f0f\u6765\u8fdb\u884c\u6570\u636e\u8bf7\u6c42"),o.a.createElement("h2",{id:"\u6838\u5fc3\u7279\u6027"},o.a.createElement("a",{"aria-hidden":"true",href:"#\u6838\u5fc3\u7279\u6027"},o.a.createElement("span",{className:"icon icon-link"})),"\u6838\u5fc3\u7279\u6027"),o.a.createElement("ul",null,o.a.createElement("li",null,"\u81ea\u52a8/\u624b\u52a8"),o.a.createElement("li",null,"\u81ea\u52a8\u8bf7\u6c42\u72b6\u6001\u7ba1\u7406(\u52a0\u8f7d/\u8d85\u65f6/\u9519\u8bef/\u8bf7\u6c42\u7ed3\u679c)"),o.a.createElement("li",null,"SWR/\u6570\u636e\u7f13\u5b58"),o.a.createElement("li",null,"\u8f6e\u8be2"),o.a.createElement("li",null,"\u8282\u6d41/\u9632\u6296"),o.a.createElement("li",null,"\u7ade\u6001"),o.a.createElement("li",null,"\u53d6\u6d88\u8bf7\u6c42"),o.a.createElement("li",null,"more...")),o.a.createElement("h2",{id:"\u57fa\u7840\u793a\u4f8b"},o.a.createElement("a",{"aria-hidden":"true",href:"#\u57fa\u7840\u793a\u4f8b"},o.a.createElement("span",{className:"icon icon-link"})),"\u57fa\u7840\u793a\u4f8b")),o.a.createElement(l.a,Object(t["a"])({source:{raw:"import React, { useState } from 'react';\r\nimport { useFetch } from '../useFetch';\r\n\r\n/**\r\n * \u6a21\u62df\u4e00\u4e2a\u57fa\u4e8ePromise\u7684\u8bf7\u6c42\u51fd\u6570\r\n */\r\nfunction mockFn(delay = 1500, isSuccess = false, res?: any) {\r\n  return function(...arg: any) {\r\n    return new Promise((resolve, reject) => {\r\n      setTimeout(() => {\r\n        isSuccess ? resolve(res || delay) : reject(res || delay);\r\n      }, delay);\r\n    });\r\n  };\r\n}\r\n\r\nconst UseFetchBase = () => {\r\n  const [count, setCount] = useState(0);\r\n  const [hasError, setError] = useState(false);\r\n  const [hasTimeout, setTimeout] = useState(false);\r\n  const [hasPoll, setPoll] = useState(false);\r\n\r\n  const { data, loading, error, timeout, send, payload, cancel } = useFetch(\r\n    mockFn(hasTimeout ? 5000 : 1000, !hasError, {\r\n      name: 'lxj',\r\n      bd: '1994-08',\r\n      timer: Date.now(),\r\n    }),\r\n    {\r\n      initPayload: { score: Math.random().toFixed(2) }, // \u4f20\u9012\u7ed9\u8bf7\u6c42\u65b9\u6cd5\u7684\u521d\u59cb\u53c2\u6570\r\n      deps: [count], // \u4f9d\u8d56\u503c\u53d1\u751f\u6539\u53d8\u65f6\u4f1a\u81ea\u52a8\u4ee5\u5f53\u524d\u53c2\u6570\u66f4\u65b0\u8bf7\u6c42\r\n      timeout: 3000, // \u8d85\u65f6\u65f6\u95f4\r\n      pollingInterval: hasPoll ? 2000 : 0, // \u8f6e\u8be2\u65f6\u95f4\r\n      cacheKey: 'USEFETCHCHACHEKEY', // \u5f00\u542f\u7f13\u5b58\u3001SWR\r\n    }\r\n  );\r\n\r\n  const retry = (\r\n    <span onClick={send} style={{ color: '#1561c4', fontSize: 14 }}>\r\n      \u91cd\u8bd5\r\n    </span>\r\n  );\r\n\r\n  return (\r\n    <div>\r\n      <div style={{ marginBottom: 12 }}>\r\n        <button onClick={send}>\u901a\u8fc7send\u8fdb\u884c\u66f4\u65b0</button>\r\n        <button onClick={() => send({ score: Math.random().toFixed(2) })}>\r\n          send\u4f20\u5165payload\u8fdb\u884c\u66f4\u65b0\r\n        </button>\r\n        <button onClick={() => setCount(prev => prev + 1)}>\r\n          \u901a\u8fc7\u6539\u53d8deps\u66f4\u65b0 {count}\r\n        </button>\r\n      </div>\r\n      <div style={{ marginBottom: 12 }}>\r\n        <button onClick={() => setError(prev => !prev)}>\r\n          \u4e0b\u6b21\u4e3a\u9519\u8bef\u8bf7\u6c42 {hasError.toString()}\r\n        </button>\r\n        <button onClick={() => setTimeout(prev => !prev)}>\r\n          \u4e0b\u6b21\u4e3a\u8d85\u65f6\u8bf7\u6c42 {hasTimeout.toString()}\r\n        </button>\r\n      </div>\r\n      <div style={{ marginBottom: 24 }}>\r\n        <button onClick={() => setPoll(prev => !prev)}>\r\n          \u8f6e\u8be2\u5f00\u5173 {hasPoll.toString()}\r\n        </button>\r\n        <button onClick={cancel}>\u53d6\u6d88\u8be5\u6b21\u8bf7\u6c42</button>\r\n      </div>\r\n      <div>\r\n        <strong>data:</strong> <div>{JSON.stringify(data, null, 4)}</div>\r\n      </div>\r\n      <div>\r\n        <strong>loading:</strong> {loading && <span>\u23f1loading...</span>}\r\n      </div>\r\n      <div>\r\n        <strong>error:</strong>\r\n        {error && (\r\n          <div>\r\n            {JSON.stringify(error)} {retry}\r\n          </div>\r\n        )}\r\n      </div>\r\n      <div>\r\n        <strong>timeout:</strong> {timeout && <span>timeout{retry}</span>}\r\n      </div>\r\n      <div>\r\n        <strong>payload</strong>\r\n        <span style={{ fontSize: 14 }}>(\u4f5c\u4e3a\u53c2\u6570\u4f20\u7ed9\u8bf7\u6c42\u65b9\u6cd5)</span>:\r\n        {JSON.stringify(payload)}\r\n      </div>\r\n      <p style={{ fontSize: 14, color: 'rgba(0,0,0,0.45)' }}>\r\n        * \u5f53\u4f20\u5165\u4e86 cacheKey\r\n        \u540e\uff0c\u4f1a\u81ea\u52a8\u5f00\u542fSWR(stale-while-revalidate)\uff0c\u5f53arg\u3001data\u3001payload\u53d1\u751f\u53d8\u66f4\u65f6\u4f1a\u5c06\u5176\u7f13\u5b58\u5230session\u4e2d\uff0c\r\n        \u4e0b\u6b21\u7ec4\u4ef6\u521d\u59cb\u5316\u65f6\uff0c\u4f1a\u5148\u8bfb\u53d6\u7f13\u5b58\u6570\u636e\u8fdb\u884c\u8fd4\u56de\uff0c\u7136\u540e\u518d\u53d1\u8d77\u66f4\u65b0\u8bf7\u6c42\u5e76\u66ff\u6362\u6389\"stale\"\u7684\u6570\u636e\uff0c\r\n        <span style={{ color: 'rgba(0,0,0,0.75)' }}>\r\n          \u5237\u65b0\u9875\u9762\u5e76\u67e5\u770bdata\u7684\u53d8\u5316\u6765\u67e5\u770bSWR\u7684\u6548\u679c\r\n        </span>\r\n      </p>\r\n\r\n      <p style={{ fontSize: 14, color: 'rgba(0,0,0,0.45)' }}>\r\n        * \u7ade\u6001?,\r\n        \u4e0e\u901a\u5e38\u610f\u4e49\u4e0a\u7684\u7ade\u6001\u7a0d\u6709\u4e0d\u540c\uff08Promise.race\u7b49\uff09\uff0c\u4f7f\u7528useFetch\u65f6\uff0c\u540e\u53d1\u8d77\u7684\u8bf7\u6c42\u4f1a\u8986\u76d6\u6389\u5148\u53d1\u8d77\u7684\u8bf7\u6c42,\r\n        \u5373\u4f7f\u8be5\u8bf7\u6c42\u53d1\u751f\u4e86\u9519\u8bef\u6216\u5176\u4ed6\u5f02\u5e38\r\n      </p>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UseFetchBase;\r\n",jsx:'<pre class="language-jsx"><code class="language-jsx"><span class="token keyword module">import</span> <span class="token maybe-class-name">React</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword module">from</span> <span class="token string">\'react\'</span><span class="token punctuation">;</span>\r\n<span class="token keyword module">import</span> <span class="token punctuation">{</span> useFetch <span class="token punctuation">}</span> <span class="token keyword module">from</span> <span class="token string">\'../useFetch\'</span><span class="token punctuation">;</span>\r\n<span class="token comment">/**\r\n * \u6a21\u62df\u4e00\u4e2a\u57fa\u4e8ePromise\u7684\u8bf7\u6c42\u51fd\u6570\r\n */</span>\r\n\r\n<span class="token keyword">function</span> <span class="token function">mockFn</span><span class="token punctuation">(</span><span class="token parameter">delay <span class="token operator">=</span> <span class="token number">1500</span><span class="token punctuation">,</span> isSuccess <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\r\n  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token spread operator">...</span>arg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\r\n    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>\r\n      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>\r\n        isSuccess <span class="token operator">?</span> <span class="token function">resolve</span><span class="token punctuation">(</span>res <span class="token operator">||</span> delay<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">reject</span><span class="token punctuation">(</span>res <span class="token operator">||</span> delay<span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n      <span class="token punctuation">}</span><span class="token punctuation">,</span> delay<span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\r\n<span class="token punctuation">}</span>\r\n\r\n<span class="token keyword">const</span> <span class="token function-variable function"><span class="token maybe-class-name">UseFetchBase</span></span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>\r\n  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n  <span class="token keyword">const</span> <span class="token punctuation">[</span>hasError<span class="token punctuation">,</span> setError<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n  <span class="token keyword">const</span> <span class="token punctuation">[</span>hasTimeout<span class="token punctuation">,</span> setTimeout<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n  <span class="token keyword">const</span> <span class="token punctuation">[</span>hasPoll<span class="token punctuation">,</span> setPoll<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n  <span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token punctuation">,</span> loading<span class="token punctuation">,</span> error<span class="token punctuation">,</span> timeout<span class="token punctuation">,</span> send<span class="token punctuation">,</span> payload<span class="token punctuation">,</span> cancel <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useFetch</span><span class="token punctuation">(</span>\r\n    <span class="token function">mockFn</span><span class="token punctuation">(</span>hasTimeout <span class="token operator">?</span> <span class="token number">5000</span> <span class="token punctuation">:</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token operator">!</span>hasError<span class="token punctuation">,</span> <span class="token punctuation">{</span>\r\n      name<span class="token punctuation">:</span> <span class="token string">\'lxj\'</span><span class="token punctuation">,</span>\r\n      bd<span class="token punctuation">:</span> <span class="token string">\'1994-08\'</span><span class="token punctuation">,</span>\r\n      timer<span class="token punctuation">:</span> <span class="token known-class-name class-name">Date</span><span class="token punctuation">.</span><span class="token method function property-access">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\r\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\r\n    <span class="token punctuation">{</span>\r\n      initPayload<span class="token punctuation">:</span> <span class="token punctuation">{</span>\r\n        score<span class="token punctuation">:</span> <span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\r\n      <span class="token punctuation">}</span><span class="token punctuation">,</span>\r\n      <span class="token comment">// \u4f20\u9012\u7ed9\u8bf7\u6c42\u65b9\u6cd5\u7684\u521d\u59cb\u53c2\u6570</span>\r\n      deps<span class="token punctuation">:</span> <span class="token punctuation">[</span>count<span class="token punctuation">]</span><span class="token punctuation">,</span>\r\n      <span class="token comment">// \u4f9d\u8d56\u503c\u53d1\u751f\u6539\u53d8\u65f6\u4f1a\u81ea\u52a8\u4ee5\u5f53\u524d\u53c2\u6570\u66f4\u65b0\u8bf7\u6c42</span>\r\n      timeout<span class="token punctuation">:</span> <span class="token number">3000</span><span class="token punctuation">,</span>\r\n      <span class="token comment">// \u8d85\u65f6\u65f6\u95f4</span>\r\n      pollingInterval<span class="token punctuation">:</span> hasPoll <span class="token operator">?</span> <span class="token number">2000</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>\r\n      <span class="token comment">// \u8f6e\u8be2\u65f6\u95f4</span>\r\n      cacheKey<span class="token punctuation">:</span> <span class="token string">\'USEFETCHCHACHEKEY\'</span><span class="token punctuation">,</span> <span class="token comment">// \u5f00\u542f\u7f13\u5b58\u3001SWR</span>\r\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\r\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n  <span class="token keyword">const</span> retry <span class="token operator">=</span> <span class="token punctuation">(</span>\r\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>span</span>\r\n      <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>send<span class="token punctuation">}</span></span>\r\n      <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>\r\n        color<span class="token punctuation">:</span> <span class="token string">\'#1561c4\'</span><span class="token punctuation">,</span>\r\n        fontSize<span class="token punctuation">:</span> <span class="token number">14</span><span class="token punctuation">,</span>\r\n      <span class="token punctuation">}</span><span class="token punctuation">}</span></span>\r\n    <span class="token punctuation">></span></span><span class="token plain-text">\r\n      \u91cd\u8bd5\r\n    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>span</span><span class="token punctuation">></span></span>\r\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n  <span class="token keyword">return</span> <span class="token punctuation">(</span>\r\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span>\r\n        <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>\r\n          marginBottom<span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">,</span>\r\n        <span class="token punctuation">}</span><span class="token punctuation">}</span></span>\r\n      <span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>send<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\u901a\u8fc7send\u8fdb\u884c\u66f4\u65b0</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span>\r\n          <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span>\r\n            <span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\r\n              score<span class="token punctuation">:</span> <span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\r\n            <span class="token punctuation">}</span><span class="token punctuation">)</span>\r\n          <span class="token punctuation">}</span></span>\r\n        <span class="token punctuation">></span></span><span class="token plain-text">\r\n          send\u4f20\u5165payload\u8fdb\u884c\u66f4\u65b0\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setCount</span><span class="token punctuation">(</span><span class="token parameter">prev</span> <span class="token arrow operator">=></span> prev <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\u901a\u8fc7\u6539\u53d8deps\u66f4\u65b0 </span><span class="token punctuation">{</span>count<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span>\r\n        <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>\r\n          marginBottom<span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">,</span>\r\n        <span class="token punctuation">}</span><span class="token punctuation">}</span></span>\r\n      <span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setError</span><span class="token punctuation">(</span><span class="token parameter">prev</span> <span class="token arrow operator">=></span> <span class="token operator">!</span>prev<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\r\n          \u4e0b\u6b21\u4e3a\u9519\u8bef\u8bf7\u6c42 </span><span class="token punctuation">{</span>hasError<span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token parameter">prev</span> <span class="token arrow operator">=></span> <span class="token operator">!</span>prev<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\r\n          \u4e0b\u6b21\u4e3a\u8d85\u65f6\u8bf7\u6c42 </span><span class="token punctuation">{</span>hasTimeout<span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span>\r\n        <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>\r\n          marginBottom<span class="token punctuation">:</span> <span class="token number">24</span><span class="token punctuation">,</span>\r\n        <span class="token punctuation">}</span><span class="token punctuation">}</span></span>\r\n      <span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setPoll</span><span class="token punctuation">(</span><span class="token parameter">prev</span> <span class="token arrow operator">=></span> <span class="token operator">!</span>prev<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\u8f6e\u8be2\u5f00\u5173 </span><span class="token punctuation">{</span>hasPoll<span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>cancel<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\u53d6\u6d88\u8be5\u6b21\u8bf7\u6c42</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>strong</span><span class="token punctuation">></span></span><span class="token plain-text">data:</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>strong</span><span class="token punctuation">></span></span><span class="token plain-text"> </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>strong</span><span class="token punctuation">></span></span><span class="token plain-text">loading:</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>strong</span><span class="token punctuation">></span></span><span class="token plain-text"> </span><span class="token punctuation">{</span>loading <span class="token operator">&#x26;&#x26;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>span</span><span class="token punctuation">></span></span><span class="token plain-text">\u23f1loading...</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>span</span><span class="token punctuation">></span></span><span class="token punctuation">}</span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>strong</span><span class="token punctuation">></span></span><span class="token plain-text">error:</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>strong</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token punctuation">{</span>error <span class="token operator">&#x26;&#x26;</span> <span class="token punctuation">(</span>\r\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n            </span><span class="token punctuation">{</span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text"> </span><span class="token punctuation">{</span>retry<span class="token punctuation">}</span><span class="token plain-text">\r\n          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span>\r\n        <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>strong</span><span class="token punctuation">></span></span><span class="token plain-text">timeout:</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>strong</span><span class="token punctuation">></span></span><span class="token plain-text"> </span><span class="token punctuation">{</span>timeout <span class="token operator">&#x26;&#x26;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>span</span><span class="token punctuation">></span></span><span class="token plain-text">timeout</span><span class="token punctuation">{</span>retry<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>span</span><span class="token punctuation">></span></span><span class="token punctuation">}</span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>strong</span><span class="token punctuation">></span></span><span class="token plain-text">payload</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>strong</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>span</span>\r\n          <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>\r\n            fontSize<span class="token punctuation">:</span> <span class="token number">14</span><span class="token punctuation">,</span>\r\n          <span class="token punctuation">}</span><span class="token punctuation">}</span></span>\r\n        <span class="token punctuation">></span></span><span class="token plain-text">\r\n          (\u4f5c\u4e3a\u53c2\u6570\u4f20\u7ed9\u8bf7\u6c42\u65b9\u6cd5)\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>span</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        :</span><span class="token punctuation">{</span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span>\r\n        <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>\r\n          fontSize<span class="token punctuation">:</span> <span class="token number">14</span><span class="token punctuation">,</span>\r\n          color<span class="token punctuation">:</span> <span class="token string">\'rgba(0,0,0,0.45)\'</span><span class="token punctuation">,</span>\r\n        <span class="token punctuation">}</span><span class="token punctuation">}</span></span>\r\n      <span class="token punctuation">></span></span><span class="token plain-text">\r\n        * \u5f53\u4f20\u5165\u4e86 cacheKey\r\n        \u540e\uff0c\u4f1a\u81ea\u52a8\u5f00\u542fSWR(stale-while-revalidate)\uff0c\u5f53arg\u3001data\u3001payload\u53d1\u751f\u53d8\u66f4\u65f6\u4f1a\u5c06\u5176\u7f13\u5b58\u5230session\u4e2d\uff0c\r\n        \u4e0b\u6b21\u7ec4\u4ef6\u521d\u59cb\u5316\u65f6\uff0c\u4f1a\u5148\u8bfb\u53d6\u7f13\u5b58\u6570\u636e\u8fdb\u884c\u8fd4\u56de\uff0c\u7136\u540e\u518d\u53d1\u8d77\u66f4\u65b0\u8bf7\u6c42\u5e76\u66ff\u6362\u6389"stale"\u7684\u6570\u636e\uff0c\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>span</span>\r\n          <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>\r\n            color<span class="token punctuation">:</span> <span class="token string">\'rgba(0,0,0,0.75)\'</span><span class="token punctuation">,</span>\r\n          <span class="token punctuation">}</span><span class="token punctuation">}</span></span>\r\n        <span class="token punctuation">></span></span><span class="token plain-text">\r\n          \u5237\u65b0\u9875\u9762\u5e76\u67e5\u770bdata\u7684\u53d8\u5316\u6765\u67e5\u770bSWR\u7684\u6548\u679c\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>span</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span>\r\n        <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>\r\n          fontSize<span class="token punctuation">:</span> <span class="token number">14</span><span class="token punctuation">,</span>\r\n          color<span class="token punctuation">:</span> <span class="token string">\'rgba(0,0,0,0.45)\'</span><span class="token punctuation">,</span>\r\n        <span class="token punctuation">}</span><span class="token punctuation">}</span></span>\r\n      <span class="token punctuation">></span></span><span class="token plain-text">\r\n        * \u7ade\u6001?,\r\n        \u4e0e\u901a\u5e38\u610f\u4e49\u4e0a\u7684\u7ade\u6001\u7a0d\u6709\u4e0d\u540c\uff08Promise.race\u7b49\uff09\uff0c\u4f7f\u7528useFetch\u65f6\uff0c\u540e\u53d1\u8d77\u7684\u8bf7\u6c42\u4f1a\u8986\u76d6\u6389\u5148\u53d1\u8d77\u7684\u8bf7\u6c42,\r\n        \u5373\u4f7f\u8be5\u8bf7\u6c42\u53d1\u751f\u4e86\u9519\u8bef\u6216\u5176\u4ed6\u5f02\u5e38\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span>\r\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\r\n\r\n<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token maybe-class-name">UseFetchBase</span><span class="token punctuation">;</span>\r\n\n</code></pre>',tsx:'<pre class="language-tsx"><code class="language-tsx"><span class="token keyword">import</span> <span class="token maybe-class-name">React</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'react\'</span><span class="token punctuation">;</span>\r\n<span class="token keyword">import</span> <span class="token punctuation">{</span> useFetch <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'../useFetch\'</span><span class="token punctuation">;</span>\r\n\r\n<span class="token comment">/**\r\n * \u6a21\u62df\u4e00\u4e2a\u57fa\u4e8ePromise\u7684\u8bf7\u6c42\u51fd\u6570\r\n */</span>\r\n<span class="token keyword">function</span> <span class="token function">mockFn</span><span class="token punctuation">(</span><span class="token parameter">delay <span class="token operator">=</span> <span class="token number">1500</span><span class="token punctuation">,</span> isSuccess <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span> res<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\r\n  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token spread operator">...</span>arg<span class="token punctuation">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\r\n    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>\r\n      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>\r\n        isSuccess <span class="token operator">?</span> <span class="token function">resolve</span><span class="token punctuation">(</span>res <span class="token operator">||</span> delay<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">reject</span><span class="token punctuation">(</span>res <span class="token operator">||</span> delay<span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n      <span class="token punctuation">}</span><span class="token punctuation">,</span> delay<span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\r\n<span class="token punctuation">}</span>\r\n\r\n<span class="token keyword">const</span> <span class="token function-variable function"><span class="token maybe-class-name">UseFetchBase</span></span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>\r\n  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n  <span class="token keyword">const</span> <span class="token punctuation">[</span>hasError<span class="token punctuation">,</span> setError<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n  <span class="token keyword">const</span> <span class="token punctuation">[</span>hasTimeout<span class="token punctuation">,</span> setTimeout<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n  <span class="token keyword">const</span> <span class="token punctuation">[</span>hasPoll<span class="token punctuation">,</span> setPoll<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n\r\n  <span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token punctuation">,</span> loading<span class="token punctuation">,</span> error<span class="token punctuation">,</span> timeout<span class="token punctuation">,</span> send<span class="token punctuation">,</span> payload<span class="token punctuation">,</span> cancel <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useFetch</span><span class="token punctuation">(</span>\r\n    <span class="token function">mockFn</span><span class="token punctuation">(</span>hasTimeout <span class="token operator">?</span> <span class="token number">5000</span> <span class="token punctuation">:</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token operator">!</span>hasError<span class="token punctuation">,</span> <span class="token punctuation">{</span>\r\n      name<span class="token punctuation">:</span> <span class="token string">\'lxj\'</span><span class="token punctuation">,</span>\r\n      bd<span class="token punctuation">:</span> <span class="token string">\'1994-08\'</span><span class="token punctuation">,</span>\r\n      timer<span class="token punctuation">:</span> <span class="token known-class-name class-name">Date</span><span class="token punctuation">.</span><span class="token method function property-access">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\r\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\r\n    <span class="token punctuation">{</span>\r\n      initPayload<span class="token punctuation">:</span> <span class="token punctuation">{</span> score<span class="token punctuation">:</span> <span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// \u4f20\u9012\u7ed9\u8bf7\u6c42\u65b9\u6cd5\u7684\u521d\u59cb\u53c2\u6570</span>\r\n      deps<span class="token punctuation">:</span> <span class="token punctuation">[</span>count<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// \u4f9d\u8d56\u503c\u53d1\u751f\u6539\u53d8\u65f6\u4f1a\u81ea\u52a8\u4ee5\u5f53\u524d\u53c2\u6570\u66f4\u65b0\u8bf7\u6c42</span>\r\n      timeout<span class="token punctuation">:</span> <span class="token number">3000</span><span class="token punctuation">,</span> <span class="token comment">// \u8d85\u65f6\u65f6\u95f4</span>\r\n      pollingInterval<span class="token punctuation">:</span> hasPoll <span class="token operator">?</span> <span class="token number">2000</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// \u8f6e\u8be2\u65f6\u95f4</span>\r\n      cacheKey<span class="token punctuation">:</span> <span class="token string">\'USEFETCHCHACHEKEY\'</span><span class="token punctuation">,</span> <span class="token comment">// \u5f00\u542f\u7f13\u5b58\u3001SWR</span>\r\n    <span class="token punctuation">}</span>\r\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n\r\n  <span class="token keyword">const</span> retry <span class="token operator">=</span> <span class="token punctuation">(</span>\r\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>span</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>send<span class="token punctuation">}</span></span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> color<span class="token punctuation">:</span> <span class="token string">\'#1561c4\'</span><span class="token punctuation">,</span> fontSize<span class="token punctuation">:</span> <span class="token number">14</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      \u91cd\u8bd5\r\n    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>span</span><span class="token punctuation">></span></span>\r\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n\r\n  <span class="token keyword">return</span> <span class="token punctuation">(</span>\r\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> marginBottom<span class="token punctuation">:</span> <span class="token number">12</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>send<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\u901a\u8fc7send\u8fdb\u884c\u66f4\u65b0</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> score<span class="token punctuation">:</span> <span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\r\n          send\u4f20\u5165payload\u8fdb\u884c\u66f4\u65b0\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setCount</span><span class="token punctuation">(</span><span class="token parameter">prev</span> <span class="token arrow operator">=></span> prev <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\r\n          \u901a\u8fc7\u6539\u53d8deps\u66f4\u65b0 </span><span class="token punctuation">{</span>count<span class="token punctuation">}</span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> marginBottom<span class="token punctuation">:</span> <span class="token number">12</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setError</span><span class="token punctuation">(</span><span class="token parameter">prev</span> <span class="token arrow operator">=></span> <span class="token operator">!</span>prev<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\r\n          \u4e0b\u6b21\u4e3a\u9519\u8bef\u8bf7\u6c42 </span><span class="token punctuation">{</span>hasError<span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token parameter">prev</span> <span class="token arrow operator">=></span> <span class="token operator">!</span>prev<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\r\n          \u4e0b\u6b21\u4e3a\u8d85\u65f6\u8bf7\u6c42 </span><span class="token punctuation">{</span>hasTimeout<span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> marginBottom<span class="token punctuation">:</span> <span class="token number">24</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setPoll</span><span class="token punctuation">(</span><span class="token parameter">prev</span> <span class="token arrow operator">=></span> <span class="token operator">!</span>prev<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\r\n          \u8f6e\u8be2\u5f00\u5173 </span><span class="token punctuation">{</span>hasPoll<span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>cancel<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\u53d6\u6d88\u8be5\u6b21\u8bf7\u6c42</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>strong</span><span class="token punctuation">></span></span><span class="token plain-text">data:</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>strong</span><span class="token punctuation">></span></span><span class="token plain-text"> </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>strong</span><span class="token punctuation">></span></span><span class="token plain-text">loading:</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>strong</span><span class="token punctuation">></span></span><span class="token plain-text"> </span><span class="token punctuation">{</span>loading <span class="token operator">&#x26;&#x26;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>span</span><span class="token punctuation">></span></span><span class="token plain-text">\u23f1loading...</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>span</span><span class="token punctuation">></span></span><span class="token punctuation">}</span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>strong</span><span class="token punctuation">></span></span><span class="token plain-text">error:</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>strong</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token punctuation">{</span>error <span class="token operator">&#x26;&#x26;</span> <span class="token punctuation">(</span>\r\n          <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n            </span><span class="token punctuation">{</span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text"> </span><span class="token punctuation">{</span>retry<span class="token punctuation">}</span><span class="token plain-text">\r\n          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span>\r\n        <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>strong</span><span class="token punctuation">></span></span><span class="token plain-text">timeout:</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>strong</span><span class="token punctuation">></span></span><span class="token plain-text"> </span><span class="token punctuation">{</span>timeout <span class="token operator">&#x26;&#x26;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>span</span><span class="token punctuation">></span></span><span class="token plain-text">timeout</span><span class="token punctuation">{</span>retry<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>span</span><span class="token punctuation">></span></span><span class="token punctuation">}</span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>strong</span><span class="token punctuation">></span></span><span class="token plain-text">payload</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>strong</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>span</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> fontSize<span class="token punctuation">:</span> <span class="token number">14</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">(\u4f5c\u4e3a\u53c2\u6570\u4f20\u7ed9\u8bf7\u6c42\u65b9\u6cd5)</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>span</span><span class="token punctuation">></span></span><span class="token plain-text">:\r\n        </span><span class="token punctuation">{</span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> fontSize<span class="token punctuation">:</span> <span class="token number">14</span><span class="token punctuation">,</span> color<span class="token punctuation">:</span> <span class="token string">\'rgba(0,0,0,0.45)\'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        * \u5f53\u4f20\u5165\u4e86 cacheKey\r\n        \u540e\uff0c\u4f1a\u81ea\u52a8\u5f00\u542fSWR(stale-while-revalidate)\uff0c\u5f53arg\u3001data\u3001payload\u53d1\u751f\u53d8\u66f4\u65f6\u4f1a\u5c06\u5176\u7f13\u5b58\u5230session\u4e2d\uff0c\r\n        \u4e0b\u6b21\u7ec4\u4ef6\u521d\u59cb\u5316\u65f6\uff0c\u4f1a\u5148\u8bfb\u53d6\u7f13\u5b58\u6570\u636e\u8fdb\u884c\u8fd4\u56de\uff0c\u7136\u540e\u518d\u53d1\u8d77\u66f4\u65b0\u8bf7\u6c42\u5e76\u66ff\u6362\u6389"stale"\u7684\u6570\u636e\uff0c\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>span</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> color<span class="token punctuation">:</span> <span class="token string">\'rgba(0,0,0,0.75)\'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\r\n          \u5237\u65b0\u9875\u9762\u5e76\u67e5\u770bdata\u7684\u53d8\u5316\u6765\u67e5\u770bSWR\u7684\u6548\u679c\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>span</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> fontSize<span class="token punctuation">:</span> <span class="token number">14</span><span class="token punctuation">,</span> color<span class="token punctuation">:</span> <span class="token string">\'rgba(0,0,0,0.45)\'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        * \u7ade\u6001?,\r\n        \u4e0e\u901a\u5e38\u610f\u4e49\u4e0a\u7684\u7ade\u6001\u7a0d\u6709\u4e0d\u540c\uff08Promise.race\u7b49\uff09\uff0c\u4f7f\u7528useFetch\u65f6\uff0c\u540e\u53d1\u8d77\u7684\u8bf7\u6c42\u4f1a\u8986\u76d6\u6389\u5148\u53d1\u8d77\u7684\u8bf7\u6c42,\r\n        \u5373\u4f7f\u8be5\u8bf7\u6c42\u53d1\u751f\u4e86\u9519\u8bef\u6216\u5176\u4ed6\u5f02\u5e38\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span>\r\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\r\n\r\n<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token maybe-class-name">UseFetchBase</span><span class="token punctuation">;</span>\r\n\n</code></pre>'}},{path:"/_demos/base",dependencies:{}}),o.a.createElement(u,null)),o.a.createElement("div",{className:"markdown"},o.a.createElement("h2",{id:"\u8282\u6d41\u9632\u6296"},o.a.createElement("a",{"aria-hidden":"true",href:"#\u8282\u6d41\u9632\u6296"},o.a.createElement("span",{className:"icon icon-link"})),"\u8282\u6d41/\u9632\u6296")),o.a.createElement(l.a,Object(t["a"])({source:{raw:"import React from 'react';\r\nimport { useFetch } from '../useFetch';\r\n\r\n/**\r\n * \u6a21\u62df\u4e00\u4e2a\u57fa\u4e8ePromise\u7684\u8bf7\u6c42\u51fd\u6570\r\n */\r\n\r\nfunction mockFn(payload: string) {\r\n  return new Promise(resolve => {\r\n    setTimeout(() => {\r\n      resolve({ code: 0, msg: `\u60a8\u8f93\u5165\u7684\u503c\u662f: ${payload}` });\r\n    }, 300);\r\n  });\r\n}\r\n\r\nconst ThrottleDebounceDemo = () => {\r\n  const { data: data1, loading: loading1, send: send1 } = useFetch(mockFn, {\r\n    throttleInterval: 1000,\r\n    manual: true,\r\n  });\r\n\r\n  const { data: data2, loading: loading2, send: send2 } = useFetch(mockFn, {\r\n    debounceInterval: 300,\r\n    manual: true,\r\n  });\r\n\r\n  return (\r\n    <div>\r\n      <h3>throttle</h3>\r\n      <p style={{ fontSize: 12 }}>1s\u5185\u53ea\u4f1a\u6267\u884c\u4e00\u6b21\u8bf7\u6c42</p>\r\n      <div>\r\n        \u8f93\u5165\u5173\u952e\u8bcd\r\n        <input type=\"text\" onChange={({ target }) = /> send1(target.value)} />\r\n        {loading1 && 'loading...'}\r\n        <p>{data1 && JSON.stringify(data1)}</p>\r\n      </div>\r\n\r\n      <h3>debounce</h3>\r\n      <p style={{ fontSize: 12 }}>\u505c\u6b62\u8f93\u5165300ms\u540e\u89e6\u53d1\u8bf7\u6c42</p>\r\n      <div>\r\n        \u8f93\u5165\u5173\u952e\u8bcd\r\n        <input type=\"text\" onChange={({ target }) = /> send2(target.value)} />\r\n        {loading2 && 'loading...'}\r\n        <p>{data2 && JSON.stringify(data2)}</p>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ThrottleDebounceDemo;\r\n",jsx:'<pre class="language-jsx"><code class="language-jsx"><span class="token keyword module">import</span> <span class="token maybe-class-name">React</span> <span class="token keyword module">from</span> <span class="token string">\'react\'</span><span class="token punctuation">;</span>\r\n<span class="token keyword module">import</span> <span class="token punctuation">{</span> useFetch <span class="token punctuation">}</span> <span class="token keyword module">from</span> <span class="token string">\'../useFetch\'</span><span class="token punctuation">;</span>\r\n<span class="token comment">/**\r\n * \u6a21\u62df\u4e00\u4e2a\u57fa\u4e8ePromise\u7684\u8bf7\u6c42\u51fd\u6570\r\n */</span>\r\n\r\n<span class="token keyword">function</span> <span class="token function">mockFn</span><span class="token punctuation">(</span><span class="token parameter">payload</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\r\n  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>\r\n    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>\r\n      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\r\n        code<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>\r\n        msg<span class="token punctuation">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">\u60a8\u8f93\u5165\u7684\u503c\u662f: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>payload<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>\r\n      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n<span class="token punctuation">}</span>\r\n\r\n<span class="token keyword">const</span> <span class="token function-variable function"><span class="token maybe-class-name">ThrottleDebounceDemo</span></span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>\r\n  <span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token punctuation">:</span> data1<span class="token punctuation">,</span> loading<span class="token punctuation">:</span> loading1<span class="token punctuation">,</span> send<span class="token punctuation">:</span> send1 <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useFetch</span><span class="token punctuation">(</span>mockFn<span class="token punctuation">,</span> <span class="token punctuation">{</span>\r\n    throttleInterval<span class="token punctuation">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>\r\n    manual<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\r\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n  <span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token punctuation">:</span> data2<span class="token punctuation">,</span> loading<span class="token punctuation">:</span> loading2<span class="token punctuation">,</span> send<span class="token punctuation">:</span> send2 <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useFetch</span><span class="token punctuation">(</span>mockFn<span class="token punctuation">,</span> <span class="token punctuation">{</span>\r\n    debounceInterval<span class="token punctuation">:</span> <span class="token number">300</span><span class="token punctuation">,</span>\r\n    manual<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\r\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n  <span class="token keyword">return</span> <span class="token punctuation">(</span>\r\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h3</span><span class="token punctuation">></span></span><span class="token plain-text">throttle</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h3</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span>\r\n        <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>\r\n          fontSize<span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">,</span>\r\n        <span class="token punctuation">}</span><span class="token punctuation">}</span></span>\r\n      <span class="token punctuation">></span></span><span class="token plain-text">\r\n        1s\u5185\u53ea\u4f1a\u6267\u884c\u4e00\u6b21\u8bf7\u6c42\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        \u8f93\u5165\u5173\u952e\u8bcd\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> target <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">send1</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\r\n        </span><span class="token punctuation">{</span>loading1 <span class="token operator">&#x26;&#x26;</span> <span class="token string">\'loading...\'</span><span class="token punctuation">}</span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span><span class="token punctuation">></span></span><span class="token punctuation">{</span>data1 <span class="token operator">&#x26;&#x26;</span> <span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span>data1<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h3</span><span class="token punctuation">></span></span><span class="token plain-text">debounce</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h3</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span>\r\n        <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>\r\n          fontSize<span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">,</span>\r\n        <span class="token punctuation">}</span><span class="token punctuation">}</span></span>\r\n      <span class="token punctuation">></span></span><span class="token plain-text">\r\n        \u505c\u6b62\u8f93\u5165300ms\u540e\u89e6\u53d1\u8bf7\u6c42\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        \u8f93\u5165\u5173\u952e\u8bcd\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> target <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">send2</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\r\n        </span><span class="token punctuation">{</span>loading2 <span class="token operator">&#x26;&#x26;</span> <span class="token string">\'loading...\'</span><span class="token punctuation">}</span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span><span class="token punctuation">></span></span><span class="token punctuation">{</span>data2 <span class="token operator">&#x26;&#x26;</span> <span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span>data2<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span>\r\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\r\n\r\n<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token maybe-class-name">ThrottleDebounceDemo</span><span class="token punctuation">;</span>\r\n\n</code></pre>',tsx:'<pre class="language-tsx"><code class="language-tsx"><span class="token keyword">import</span> <span class="token maybe-class-name">React</span> <span class="token keyword">from</span> <span class="token string">\'react\'</span><span class="token punctuation">;</span>\r\n<span class="token keyword">import</span> <span class="token punctuation">{</span> useFetch <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'../useFetch\'</span><span class="token punctuation">;</span>\r\n\r\n<span class="token comment">/**\r\n * \u6a21\u62df\u4e00\u4e2a\u57fa\u4e8ePromise\u7684\u8bf7\u6c42\u51fd\u6570\r\n */</span>\r\n\r\n<span class="token keyword">function</span> <span class="token function">mockFn</span><span class="token punctuation">(</span><span class="token parameter">payload<span class="token punctuation">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\r\n  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>\r\n    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>\r\n      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span> code<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> msg<span class="token punctuation">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">\u60a8\u8f93\u5165\u7684\u503c\u662f: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>payload<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n<span class="token punctuation">}</span>\r\n\r\n<span class="token keyword">const</span> <span class="token function-variable function"><span class="token maybe-class-name">ThrottleDebounceDemo</span></span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>\r\n  <span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token punctuation">:</span> data1<span class="token punctuation">,</span> loading<span class="token punctuation">:</span> loading1<span class="token punctuation">,</span> send<span class="token punctuation">:</span> send1 <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useFetch</span><span class="token punctuation">(</span>mockFn<span class="token punctuation">,</span> <span class="token punctuation">{</span>\r\n    throttleInterval<span class="token punctuation">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>\r\n    manual<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\r\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n\r\n  <span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token punctuation">:</span> data2<span class="token punctuation">,</span> loading<span class="token punctuation">:</span> loading2<span class="token punctuation">,</span> send<span class="token punctuation">:</span> send2 <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useFetch</span><span class="token punctuation">(</span>mockFn<span class="token punctuation">,</span> <span class="token punctuation">{</span>\r\n    debounceInterval<span class="token punctuation">:</span> <span class="token number">300</span><span class="token punctuation">,</span>\r\n    manual<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\r\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n\r\n  <span class="token keyword">return</span> <span class="token punctuation">(</span>\r\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h3</span><span class="token punctuation">></span></span><span class="token plain-text">throttle</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h3</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> fontSize<span class="token punctuation">:</span> <span class="token number">12</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">1s\u5185\u53ea\u4f1a\u6267\u884c\u4e00\u6b21\u8bf7\u6c42</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        \u8f93\u5165\u5173\u952e\u8bcd\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> target <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">send1</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\r\n        </span><span class="token punctuation">{</span>loading1 <span class="token operator">&#x26;&#x26;</span> <span class="token string">\'loading...\'</span><span class="token punctuation">}</span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span><span class="token punctuation">></span></span><span class="token punctuation">{</span>data1 <span class="token operator">&#x26;&#x26;</span> <span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span>data1<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h3</span><span class="token punctuation">></span></span><span class="token plain-text">debounce</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h3</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> fontSize<span class="token punctuation">:</span> <span class="token number">12</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\u505c\u6b62\u8f93\u5165300ms\u540e\u89e6\u53d1\u8bf7\u6c42</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        \u8f93\u5165\u5173\u952e\u8bcd\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> target <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">send2</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\r\n        </span><span class="token punctuation">{</span>loading2 <span class="token operator">&#x26;&#x26;</span> <span class="token string">\'loading...\'</span><span class="token punctuation">}</span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span><span class="token punctuation">></span></span><span class="token punctuation">{</span>data2 <span class="token operator">&#x26;&#x26;</span> <span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span>data2<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span>\r\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\r\n\r\n<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token maybe-class-name">ThrottleDebounceDemo</span><span class="token punctuation">;</span>\r\n\n</code></pre>'}},{path:"/_demos/throttle-debounce",dependencies:{}}),o.a.createElement(r,null)),o.a.createElement("div",{className:"markdown"},o.a.createElement("h2",{id:"\u61d2\u4eba\u6a21\u5f0f"},o.a.createElement("a",{"aria-hidden":"true",href:"#\u61d2\u4eba\u6a21\u5f0f"},o.a.createElement("span",{className:"icon icon-link"})),"\u61d2\u4eba\u6a21\u5f0f"),o.a.createElement("p",null,"\u8c03\u7528",o.a.createElement("code",null,"send"),"\u5f88\u9ebb\u70e6\uff0c\u5927\u90e8\u5206\u4e1a\u52a1\u4e2d\uff0c\u7406\u60f3\u7684\u8bf7\u6c42\u65f6\u673a\u662f\u67d0\u4e2a\u4f9d\u8d56\u7684\u503c\u53d1\u751f\u6539\u53d8\u65f6\uff0c\u901a\u8fc7",o.a.createElement("code",null,"param"),"\uff0c\u53ef\u4ee5\u8f7b\u677e\u7684\u5b9e\u73b0\u8fd9\u4e00\u70b9")),o.a.createElement(l.a,Object(t["a"])({source:{raw:"import React, { useState } from 'react';\r\nimport { useFetch } from '../useFetch';\r\n\r\n/**\r\n * \u6a21\u62df\u4e00\u4e2a\u57fa\u4e8ePromise\u7684\u8bf7\u6c42\u51fd\u6570\r\n */\r\n\r\nfunction mockFn(payload: string) {\r\n  return new Promise(resolve => {\r\n    setTimeout(() => {\r\n      resolve({ code: 0, data: payload });\r\n    }, 500);\r\n  });\r\n}\r\n\r\nconst ParamDemo = () => {\r\n  const [id, setId] = useState(1);\r\n\r\n  const { data, loading, param } = useFetch(mockFn, {\r\n    param: {\r\n      name: 'lxj',\r\n      id,\r\n    },\r\n  });\r\n\r\n  return (\r\n    <div>\r\n      <h3>ParamDemo {loading && 'loading...'}</h3>\r\n      <div style={{ marginBottom: 16 }}>\r\n        <button onClick={() => setId(prev => prev + 1)}>change id {id}</button>\r\n      </div>\r\n      <div>\r\n        <strong>current param:</strong> {JSON.stringify(param)}\r\n      </div>\r\n      <div>\r\n        <strong>data</strong>\r\n        <span style={{ fontSize: 14 }}>(\u8fd4\u56de\u8bf7\u6c42\u65f6\u7684\u53c2\u6570):</span>{' '}\r\n        {JSON.stringify(data)}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ParamDemo;\r\n",jsx:'<pre class="language-jsx"><code class="language-jsx"><span class="token keyword module">import</span> <span class="token maybe-class-name">React</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword module">from</span> <span class="token string">\'react\'</span><span class="token punctuation">;</span>\r\n<span class="token keyword module">import</span> <span class="token punctuation">{</span> useFetch <span class="token punctuation">}</span> <span class="token keyword module">from</span> <span class="token string">\'../useFetch\'</span><span class="token punctuation">;</span>\r\n<span class="token comment">/**\r\n * \u6a21\u62df\u4e00\u4e2a\u57fa\u4e8ePromise\u7684\u8bf7\u6c42\u51fd\u6570\r\n */</span>\r\n\r\n<span class="token keyword">function</span> <span class="token function">mockFn</span><span class="token punctuation">(</span><span class="token parameter">payload</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\r\n  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>\r\n    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>\r\n      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\r\n        code<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>\r\n        data<span class="token punctuation">:</span> payload<span class="token punctuation">,</span>\r\n      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n<span class="token punctuation">}</span>\r\n\r\n<span class="token keyword">const</span> <span class="token function-variable function"><span class="token maybe-class-name">ParamDemo</span></span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>\r\n  <span class="token keyword">const</span> <span class="token punctuation">[</span>id<span class="token punctuation">,</span> setId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n  <span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token punctuation">,</span> loading<span class="token punctuation">,</span> param <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useFetch</span><span class="token punctuation">(</span>mockFn<span class="token punctuation">,</span> <span class="token punctuation">{</span>\r\n    param<span class="token punctuation">:</span> <span class="token punctuation">{</span>\r\n      name<span class="token punctuation">:</span> <span class="token string">\'lxj\'</span><span class="token punctuation">,</span>\r\n      id<span class="token punctuation">,</span>\r\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\r\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n  <span class="token keyword">return</span> <span class="token punctuation">(</span>\r\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h3</span><span class="token punctuation">></span></span><span class="token plain-text">ParamDemo </span><span class="token punctuation">{</span>loading <span class="token operator">&#x26;&#x26;</span> <span class="token string">\'loading...\'</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h3</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span>\r\n        <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>\r\n          marginBottom<span class="token punctuation">:</span> <span class="token number">16</span><span class="token punctuation">,</span>\r\n        <span class="token punctuation">}</span><span class="token punctuation">}</span></span>\r\n      <span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setId</span><span class="token punctuation">(</span><span class="token parameter">prev</span> <span class="token arrow operator">=></span> prev <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">change id </span><span class="token punctuation">{</span>id<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>strong</span><span class="token punctuation">></span></span><span class="token plain-text">current param:</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>strong</span><span class="token punctuation">></span></span><span class="token plain-text"> </span><span class="token punctuation">{</span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>strong</span><span class="token punctuation">></span></span><span class="token plain-text">data</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>strong</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>span</span>\r\n          <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>\r\n            fontSize<span class="token punctuation">:</span> <span class="token number">14</span><span class="token punctuation">,</span>\r\n          <span class="token punctuation">}</span><span class="token punctuation">}</span></span>\r\n        <span class="token punctuation">></span></span><span class="token plain-text">\r\n          (\u8fd4\u56de\u8bf7\u6c42\u65f6\u7684\u53c2\u6570):\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>span</span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token string">\' \'</span><span class="token punctuation">}</span><span class="token plain-text">\r\n        </span><span class="token punctuation">{</span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span>\r\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\r\n\r\n<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token maybe-class-name">ParamDemo</span><span class="token punctuation">;</span>\r\n\n</code></pre>',tsx:'<pre class="language-tsx"><code class="language-tsx"><span class="token keyword">import</span> <span class="token maybe-class-name">React</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'react\'</span><span class="token punctuation">;</span>\r\n<span class="token keyword">import</span> <span class="token punctuation">{</span> useFetch <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'../useFetch\'</span><span class="token punctuation">;</span>\r\n\r\n<span class="token comment">/**\r\n * \u6a21\u62df\u4e00\u4e2a\u57fa\u4e8ePromise\u7684\u8bf7\u6c42\u51fd\u6570\r\n */</span>\r\n\r\n<span class="token keyword">function</span> <span class="token function">mockFn</span><span class="token punctuation">(</span><span class="token parameter">payload<span class="token punctuation">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\r\n  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>\r\n    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>\r\n      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span> code<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> data<span class="token punctuation">:</span> payload <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n<span class="token punctuation">}</span>\r\n\r\n<span class="token keyword">const</span> <span class="token function-variable function"><span class="token maybe-class-name">ParamDemo</span></span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>\r\n  <span class="token keyword">const</span> <span class="token punctuation">[</span>id<span class="token punctuation">,</span> setId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n\r\n  <span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token punctuation">,</span> loading<span class="token punctuation">,</span> param <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useFetch</span><span class="token punctuation">(</span>mockFn<span class="token punctuation">,</span> <span class="token punctuation">{</span>\r\n    param<span class="token punctuation">:</span> <span class="token punctuation">{</span>\r\n      name<span class="token punctuation">:</span> <span class="token string">\'lxj\'</span><span class="token punctuation">,</span>\r\n      id<span class="token punctuation">,</span>\r\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\r\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n\r\n  <span class="token keyword">return</span> <span class="token punctuation">(</span>\r\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h3</span><span class="token punctuation">></span></span><span class="token plain-text">ParamDemo </span><span class="token punctuation">{</span>loading <span class="token operator">&#x26;&#x26;</span> <span class="token string">\'loading...\'</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h3</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> marginBottom<span class="token punctuation">:</span> <span class="token number">16</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setId</span><span class="token punctuation">(</span><span class="token parameter">prev</span> <span class="token arrow operator">=></span> prev <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">change id </span><span class="token punctuation">{</span>id<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>strong</span><span class="token punctuation">></span></span><span class="token plain-text">current param:</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>strong</span><span class="token punctuation">></span></span><span class="token plain-text"> </span><span class="token punctuation">{</span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>strong</span><span class="token punctuation">></span></span><span class="token plain-text">data</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>strong</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>span</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> fontSize<span class="token punctuation">:</span> <span class="token number">14</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">(\u8fd4\u56de\u8bf7\u6c42\u65f6\u7684\u53c2\u6570):</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>span</span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token string">\' \'</span><span class="token punctuation">}</span><span class="token plain-text">\r\n        </span><span class="token punctuation">{</span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span>\r\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\r\n\r\n<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token maybe-class-name">ParamDemo</span><span class="token punctuation">;</span>\r\n\n</code></pre>'}},{path:"/_demos/param",dependencies:{}}),o.a.createElement(k,null)),o.a.createElement("div",{className:"markdown"},o.a.createElement("blockquote",null,o.a.createElement("p",null,"\ud83d\udca1 \u5185\u90e8\u901a\u8fc7_.isEqual \u6765\u5bf9\u6bd4 param \u76f8\u7b49\u6027\uff0c\u4fdd\u6301 param \u7ed3\u6784\u76f8\u5bf9\u7b80\u5355\u80fd\u591f\u51cf\u5c11\u5bf9\u6bd4\u6df1\u5ea6\uff0c\u4ece\u800c\u63d0\u9ad8\u6027\u80fd")),o.a.createElement("blockquote",null,o.a.createElement("p",null,"\ud83d\udca1 \u4e3a\u4ec0\u4e48",o.a.createElement("code",null,"cacheKey"),"\u6ca1\u6709\u7f13\u5b58 param?")),o.a.createElement("p",null,"param \u662f\u4e0d\u53ef\u63a7\u7684\u3001\u5b8c\u5168\u7531\u5916\u90e8\u4f20\u5165\u7684\u72b6\u6001\uff0c\u7f13\u5b58 param \u4f1a\u5728\u5f88\u591a\u60c5\u51b5\u4e0b\u9020\u6210\u5185\u5916\u4e0d\u4e00\u81f4\uff0c\u5982\u679c\u9700\u8981\u7f13\u5b58 param\uff0c\u5728",o.a.createElement("code",null,"useFetch"),"\u5916\u4f7f\u7528",o.a.createElement(p["Link"],{to:"/#/state/use-storage-state"},"useStorageState"),"\u6765\u7ba1\u7406 param \u6216\u8005\u5c06\u9875\u9762\u53c2\u6570\u5b58\u5230 url \u4e2d\u662f\u66f4\u53ef\u9760\u7684\u505a\u6cd5"),o.a.createElement("h2",{id:"api"},o.a.createElement("a",{"aria-hidden":"true",href:"#api"},o.a.createElement("span",{className:"icon icon-link"})),"API"),o.a.createElement("pre",{className:"language-ts"},o.a.createElement("code",{className:"language-ts"},o.a.createElement("span",{className:"token keyword"},"const")," bonus ",o.a.createElement("span",{className:"token operator"},"=")," ",o.a.createElement("span",{className:"token function"},"useFetch"),o.a.createElement("span",{className:"token punctuation"},"("),"method",o.a.createElement("span",{className:"token punctuation"},",")," options",o.a.createElement("span",{className:"token operator"},"?"),o.a.createElement("span",{className:"token punctuation"},")"),o.a.createElement("span",{className:"token punctuation"},";"),o.a.createElement("br",null))),o.a.createElement("p",null,o.a.createElement("strong",null,"method")," - \u4e00\u4e2a Promise return \u51fd\u6570\u6216 async \u51fd\u6570, \u5f53\u4e0d\u4e3a\u51fd\u6570\u65f6\u4e0d\u4f1a\u8d70\u8bf7\u6c42\u6d41\u7a0b, \u53ef\u85c9\u6b64\u5b9e\u73b0\u4e32\u8fde\u8bf7\u6c42"),o.a.createElement("p",null,o.a.createElement("strong",null,"options")," - \u914d\u7f6e"),o.a.createElement("pre",{className:"language-ts"},o.a.createElement("code",{className:"language-ts"},o.a.createElement("span",{className:"token keyword"},"interface")," ",o.a.createElement("span",{className:"token class-name"},"UseFetchOptions"),o.a.createElement("span",{className:"token operator"},"<"),o.a.createElement("span",{className:"token maybe-class-name"},"Data"),o.a.createElement("span",{className:"token punctuation"},",")," ",o.a.createElement("span",{className:"token maybe-class-name"},"Payload"),o.a.createElement("span",{className:"token operator"},">")," ",o.a.createElement("span",{className:"token punctuation"},"{"),o.a.createElement("br",null)," ",o.a.createElement("span",{className:"token doc-comment comment"}," /** [] | \u7c7b\u4f3cuseEffect(fn, deps)\uff0c\u5f53\u4f9d\u8d56\u6570\u7ec4\u5185\u7684\u503c\u53d1\u751f\u6539\u53d8\u65f6\uff0c\u4f1a\u4ee5\u5f53\u524d\u53c2\u6570\u8fdb\u884c\u66f4\u65b0\u8bf7\u6c42, \u8bf7\u52ff\u4f20\u5165\u672amemo\u7684\u5f15\u7528\u7c7b\u578b\u503c */"),o.a.createElement("br",null),"  deps",o.a.createElement("span",{className:"token operator"},"?"),o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token builtin"},"any"),o.a.createElement("span",{className:"token punctuation"},"["),o.a.createElement("span",{className:"token punctuation"},"]"),o.a.createElement("span",{className:"token punctuation"},";"),o.a.createElement("br",null)," ",o.a.createElement("span",{className:"token doc-comment comment"}," /** \u4f20\u9012\u7ed9\u8bf7\u6c42\u51fd\u6570\u7684\u53c2\u6570, \u5f53\u53d1\u751f\u6539\u53d8\u65f6\uff0c\u4f1a\u4ee5\u65b0\u503c\u53d1\u8d77\u8c03\u7528\u8bf7\u6c42\u3002\u4f20\u9012\u6b64\u9879\u65f6\uff0cPayload\u4f1a\u88ab\u5ffd\u7565\u3002\u4e0epayload\u5171\u7528Payload\u7c7b\u578b */"),o.a.createElement("br",null),"  param",o.a.createElement("span",{className:"token operator"},"?"),o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token maybe-class-name"},"Payload"),o.a.createElement("span",{className:"token punctuation"},";"),o.a.createElement("br",null)," ",o.a.createElement("span",{className:"token doc-comment comment"}," /** false | \u53ea\u80fd\u901a\u8fc7send\u6765\u89e6\u53d1\u8bf7\u6c42 */"),o.a.createElement("br",null),"  manual",o.a.createElement("span",{className:"token operator"},"?"),o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token builtin"},"boolean"),o.a.createElement("span",{className:"token punctuation"},";"),o.a.createElement("br",null)," ",o.a.createElement("span",{className:"token doc-comment comment"}," /** 10000 | \u8d85\u65f6\u65f6\u95f4 ms*/"),o.a.createElement("br",null),"  timeout",o.a.createElement("span",{className:"token operator"},"?"),o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token builtin"},"number"),o.a.createElement("span",{className:"token punctuation"},";"),o.a.createElement("br",null)," ",o.a.createElement("span",{className:"token doc-comment comment"}," /** \u521d\u59cbdata */"),o.a.createElement("br",null),"  initData",o.a.createElement("span",{className:"token operator"},"?"),o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token punctuation"},"("),o.a.createElement("span",{className:"token punctuation"},"("),o.a.createElement("span",{className:"token punctuation"},")")," ",o.a.createElement("span",{className:"token arrow operator"},"=>")," ",o.a.createElement("span",{className:"token maybe-class-name"},"Data"),o.a.createElement("span",{className:"token punctuation"},")")," ",o.a.createElement("span",{className:"token operator"},"|")," ",o.a.createElement("span",{className:"token maybe-class-name"},"Data"),o.a.createElement("span",{className:"token punctuation"},";"),o.a.createElement("br",null)," ",o.a.createElement("span",{className:"token doc-comment comment"}," /** \u521d\u59cbpayload, \u5728\u4e0d\u5b58\u5728param\u914d\u7f6e\u65f6\uff0c\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u7ed9\u8bf7\u6c42\u65b9\u6cd5 */"),o.a.createElement("br",null),"  initPayload",o.a.createElement("span",{className:"token operator"},"?"),o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token punctuation"},"("),o.a.createElement("span",{className:"token punctuation"},"("),o.a.createElement("span",{className:"token punctuation"},")")," ",o.a.createElement("span",{className:"token arrow operator"},"=>")," ",o.a.createElement("span",{className:"token maybe-class-name"},"Payload"),o.a.createElement("span",{className:"token punctuation"},")")," ",o.a.createElement("span",{className:"token operator"},"|")," ",o.a.createElement("span",{className:"token maybe-class-name"},"Payload"),o.a.createElement("span",{className:"token punctuation"},";"),o.a.createElement("br",null)," ",o.a.createElement("span",{className:"token doc-comment comment"}," /** \u6210\u529f\u56de\u8c03, \u5f53\u4e3a\u66f4\u65b0\u8bf7\u6c42(\u901a\u8fc7\u65e0\u53c2\u8c03\u7528send\u3001deps\u7b49\u914d\u7f6e\u53d1\u8d77\u8bf7\u6c42)\u65f6\uff0cisUpdate\u4e3atrue */"),o.a.createElement("br",null),"  onSuccess",o.a.createElement("span",{className:"token operator"},"?"),o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token punctuation"},"("),o.a.createElement("span",{className:"token parameter"},"result",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token maybe-class-name"},"Data"),o.a.createElement("span",{className:"token punctuation"},",")," isUpdate",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token builtin"},"boolean")),o.a.createElement("span",{className:"token punctuation"},")")," ",o.a.createElement("span",{className:"token arrow operator"},"=>")," ",o.a.createElement("span",{className:"token keyword"},"void"),o.a.createElement("span",{className:"token punctuation"},";"),o.a.createElement("br",null)," ",o.a.createElement("span",{className:"token doc-comment comment"}," /** \u9519\u8bef\u56de\u8c03\uff0c error\u4e3a\u8bf7\u6c42\u51fd\u6570\u4e2d\u629b\u51fa\u7684\u9519\u8bef */"),o.a.createElement("br",null),"  onError",o.a.createElement("span",{className:"token operator"},"?"),o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token punctuation"},"("),o.a.createElement("span",{className:"token parameter"},"error",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token builtin"},"any")),o.a.createElement("span",{className:"token punctuation"},")")," ",o.a.createElement("span",{className:"token arrow operator"},"=>")," ",o.a.createElement("span",{className:"token keyword"},"void"),o.a.createElement("span",{className:"token punctuation"},";"),o.a.createElement("br",null)," ",o.a.createElement("span",{className:"token doc-comment comment"}," /** \u65e0\u8bba\u6210\u529f\u4e0e\u5426\u90fd\u4f1a\u8c03\u7528\u3002\u5728\u65e7\u7684\u8bf7\u6c42\u88ab\u65b0\u7684\u8bf7\u6c42\u8986\u76d6\u6389\u65f6\uff0c\u4e0d\u4f1a\u89e6\u53d1\u3002 */"),o.a.createElement("br",null),"  onComplete",o.a.createElement("span",{className:"token operator"},"?"),o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token punctuation"},"("),o.a.createElement("span",{className:"token punctuation"},")")," ",o.a.createElement("span",{className:"token arrow operator"},"=>")," ",o.a.createElement("span",{className:"token keyword"},"void"),o.a.createElement("span",{className:"token punctuation"},";"),o.a.createElement("br",null)," ",o.a.createElement("span",{className:"token doc-comment comment"}," /** \u8bf7\u6c42\u8d85\u65f6\u7684\u56de\u8c03 */"),o.a.createElement("br",null),"  onTimeout",o.a.createElement("span",{className:"token operator"},"?"),o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token punctuation"},"("),o.a.createElement("span",{className:"token punctuation"},")")," ",o.a.createElement("span",{className:"token arrow operator"},"=>")," ",o.a.createElement("span",{className:"token keyword"},"void"),o.a.createElement("span",{className:"token punctuation"},";"),o.a.createElement("br",null)," ",o.a.createElement("span",{className:"token doc-comment comment"}," /** \u7528\u4e8e\u7f13\u5b58\u7684key\uff0c\u4f20\u9012\u540e\uff0c\u4f1a\u5c06(payload, data, arg)\u7f13\u5b58\u5230session\u4e2d\uff0c\u4e0b\u6b21\u52a0\u8f7d\u65f6\u5c06\u8bfb\u53d6\u7f13\u5b58\u6570\u636e\u4f5c\u4e3a\u521d\u59cb\u503c */"),o.a.createElement("br",null),"  cacheKey",o.a.createElement("span",{className:"token operator"},"?"),o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token builtin"},"string"),o.a.createElement("span",{className:"token punctuation"},";"),o.a.createElement("br",null)," ",o.a.createElement("span",{className:"token doc-comment comment"}," /** true | \u5f53\u4f20\u5165\u4e86cacheKey\u4e14\u5b58\u5728\u7f13\u5b58\u6570\u636e\u65f6\uff0c\u662f\u5426\u8fdb\u884cswr(stale-while-revalidate)\u8bf7\u6c42 */"),o.a.createElement("br",null),"  stale",o.a.createElement("span",{className:"token operator"},"?"),o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token builtin"},"boolean"),o.a.createElement("span",{className:"token punctuation"},";"),o.a.createElement("br",null)," ",o.a.createElement("span",{className:"token doc-comment comment"}," /** \u8282\u6d41\u95f4\u9694\u65f6\u95f4\uff0c\u4f20\u5165\u65f6\uff0c\u5f00\u542f\u8282\u6d41, \u53ea\u6709\u521d\u59cb\u5316\u65f6\u7684\u914d\u7f6e\u4f1a\u751f\u6548 */"),o.a.createElement("br",null),"  throttleInterval",o.a.createElement("span",{className:"token operator"},"?"),o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token builtin"},"number"),o.a.createElement("span",{className:"token punctuation"},";"),o.a.createElement("br",null)," ",o.a.createElement("span",{className:"token doc-comment comment"}," /** \u9632\u6296\u95f4\u9694\u65f6\u95f4\uff0c\u4f20\u5165\u65f6\uff0c\u5f00\u542f\u9632\u6296, \u53ea\u6709\u521d\u59cb\u5316\u65f6\u7684\u914d\u7f6e\u4f1a\u751f\u6548, \u5f53\u5b58\u5728throttleInterval\u65f6\uff0c\u6b64\u914d\u7f6e\u4e0d\u4f1a\u751f\u6548 */"),o.a.createElement("br",null),"  debounceInterval",o.a.createElement("span",{className:"token operator"},"?"),o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token builtin"},"number"),o.a.createElement("span",{className:"token punctuation"},";"),o.a.createElement("br",null)," ",o.a.createElement("span",{className:"token doc-comment comment"}," /** \u8f6e\u8be2\u95f4\u9694, \u5927\u4e8e500\u65f6\u751f\u6548 */"),o.a.createElement("br",null),"  pollingInterval",o.a.createElement("span",{className:"token operator"},"?"),o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token builtin"},"number"),o.a.createElement("span",{className:"token punctuation"},";"),o.a.createElement("br",null),o.a.createElement("span",{className:"token punctuation"},"}"),o.a.createElement("br",null))),o.a.createElement("p",null,o.a.createElement("strong",null,"bonus")),o.a.createElement("pre",{className:"language-ts"},o.a.createElement("code",{className:"language-ts"},o.a.createElement("span",{className:"token keyword"},"interface")," ",o.a.createElement("span",{className:"token class-name"},"UseFetchReturns"),o.a.createElement("span",{className:"token operator"},"<"),o.a.createElement("span",{className:"token maybe-class-name"},"Data"),o.a.createElement("span",{className:"token punctuation"},",")," ",o.a.createElement("span",{className:"token maybe-class-name"},"Payload"),o.a.createElement("span",{className:"token operator"},">")," ",o.a.createElement("span",{className:"token punctuation"},"{"),o.a.createElement("br",null)," ",o.a.createElement("span",{className:"token doc-comment comment"}," /** \u662f\u5426\u6b63\u5728\u8bf7\u6c42 */"),o.a.createElement("br",null),"  loading",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token builtin"},"boolean"),o.a.createElement("span",{className:"token punctuation"},";"),o.a.createElement("br",null)," ",o.a.createElement("span",{className:"token doc-comment comment"}," /** method\u65b9\u6cd5reject\u65f6\uff0cerror\u4e3a\u5b83reject\u7684\u503c\u3002 */"),o.a.createElement("br",null),"  error",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token builtin"},"any"),o.a.createElement("span",{className:"token punctuation"},";"),o.a.createElement("br",null)," ",o.a.createElement("span",{className:"token doc-comment comment"}," /** \u8bf7\u6c42\u8d85\u65f6\u8bbe\u7f6e\u4e3atrue */"),o.a.createElement("br",null),"  timeout",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token builtin"},"boolean"),o.a.createElement("span",{className:"token punctuation"},";"),o.a.createElement("br",null)," ",o.a.createElement("span",{className:"token doc-comment comment"}," /** method\u65b9\u6cd5resolve\u7684\u503c\u6216initData */"),o.a.createElement("br",null),"  data",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token maybe-class-name"},"Data")," ",o.a.createElement("span",{className:"token operator"},"|")," undefined",o.a.createElement("span",{className:"token punctuation"},";"),o.a.createElement("br",null)," ",o.a.createElement("span",{className:"token doc-comment comment"}," /** \u5f53\u524d\u7528\u4e8e\u8bf7\u6c42\u7684payload\u6216initPayload */"),o.a.createElement("br",null),"  payload",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token maybe-class-name"},"Payload")," ",o.a.createElement("span",{className:"token operator"},"|")," undefined",o.a.createElement("span",{className:"token punctuation"},";"),o.a.createElement("br",null)," ",o.a.createElement("span",{className:"token doc-comment comment"}," /** \u5f53\u524d\u7528\u4e8e\u8bf7\u6c42\u7684param */"),o.a.createElement("br",null),"  param",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token maybe-class-name"},"Payload"),o.a.createElement("span",{className:"token punctuation"},";"),o.a.createElement("br",null)," ",o.a.createElement("span",{className:"token doc-comment comment"}," /** \u8bbe\u7f6e\u5f53\u524d\u7684data */"),o.a.createElement("br",null),"  setData",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token maybe-class-name"},"SetStateBase"),o.a.createElement("span",{className:"token operator"},"<"),o.a.createElement("span",{className:"token maybe-class-name"},"Data"),o.a.createElement("span",{className:"token operator"},">"),o.a.createElement("span",{className:"token punctuation"},";"),o.a.createElement("br",null)," ",o.a.createElement("span",{className:"token doc-comment comment"}," /** \u53d6\u6d88\u8bf7\u6c42 */"),o.a.createElement("br",null),"  ",o.a.createElement("span",{className:"token function-variable function"},"cancel"),o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token punctuation"},"("),o.a.createElement("span",{className:"token punctuation"},")")," ",o.a.createElement("span",{className:"token arrow operator"},"=>")," ",o.a.createElement("span",{className:"token keyword"},"void"),o.a.createElement("span",{className:"token punctuation"},";"),o.a.createElement("br",null)," ",o.a.createElement("span",{className:"token doc-comment comment"}," /** \u8f6e\u8be2\u7684\u5f00\u5173\u72b6\u6001\uff0c\u8f6e\u8be2\u8fd8\u4f9d\u8d56\u4e8epollingInterval\u914d\u7f6e\uff0c\u53ea\u6709\u4e24\u8005\u540c\u65f6\u6709\u6548\u65f6\u624d\u4f1a\u5f00\u542f\u8f6e\u8be2 */"),o.a.createElement("br",null),"  polling",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token builtin"},"boolean"),o.a.createElement("span",{className:"token punctuation"},";"),o.a.createElement("br",null)," ",o.a.createElement("span",{className:"token doc-comment comment"}," /** \u8bbe\u7f6e\u8f6e\u8be2\u72b6\u6001 */"),o.a.createElement("br",null),"  ",o.a.createElement("span",{className:"token function"},"setPolling"),o.a.createElement("span",{className:"token punctuation"},"("),"patch",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token builtin"},"boolean")," ",o.a.createElement("span",{className:"token operator"},"|")," ",o.a.createElement("span",{className:"token punctuation"},"("),o.a.createElement("span",{className:"token punctuation"},"("),o.a.createElement("span",{className:"token parameter"},"prev",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token builtin"},"boolean")),o.a.createElement("span",{className:"token punctuation"},")")," ",o.a.createElement("span",{className:"token arrow operator"},"=>")," ",o.a.createElement("span",{className:"token builtin"},"boolean"),o.a.createElement("span",{className:"token punctuation"},")"),o.a.createElement("span",{className:"token punctuation"},")"),o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token keyword"},"void"),o.a.createElement("span",{className:"token punctuation"},";"),o.a.createElement("br",null)," ",o.a.createElement("span",{className:"token doc-comment comment"}," /**",o.a.createElement("br",null),"   * \u6839\u636e\u53c2\u6570\u7c7b\u578b\u4e0d\u540c\uff0c\u4f1a\u6709\u4e0d\u540c\u6548\u679c:",o.a.createElement("br",null),"   * \u5e26\u53c2\u6570: \u4ee5\u65b0\u7684payload\u53d1\u8d77\u8bf7\u6c42\u5e76\u8bbe\u7f6epayload",o.a.createElement("br",null),"   * \u65e0\u53c2\u6570/\u53c2\u6570\u4e3a\u5408\u6210\u4e8b\u4ef6: \u4ee5\u5f53\u524d\u53c2\u6570\u53d1\u8d77\u66f4\u65b0",o.a.createElement("br",null),"   * \u4f20\u5165\u4e86param\u914d\u7f6e\u9879: \u5f53\u5b58\u5728param\u914d\u7f6e\uff0c\u4e00\u5f8b\u89c6\u4e3a\u66f4\u65b0\u5e76\u4ee5\u5f53\u524darg\u7684\u503c\u53d1\u8d77\u66f4\u65b0. \u6b64\u65f6\uff0c\u4f20\u5165\u7684payload\u4f1a\u88ab\u5ffd\u7565",o.a.createElement("br",null),"   *",o.a.createElement("br",null),"   * \u8fd4\u56de\u9519\u8bef\u4f18\u5148\u7684Promise:",o.a.createElement("br",null),"   * \u5982\u679c\u8be5\u6b21\u8bf7\u6c42\u6709\u6548\uff0c\u8fd4\u56de\u4e00\u4e2a\u5fc5\u5b9aresolve\u6570\u7ec4[err, res]\u7684Promise\uff0cerr\u4e3areject\u7684\u7ed3\u679c(\u4e0d\u4e3anull\u8bf4\u660e\u8be5\u6b21\u8bf7\u6c42\u53d1\u751f\u4e86\u9519\u8bef)\uff0cres\u4e3aresolve\u7684\u7ed3\u679c */"),o.a.createElement("br",null),"  send",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token punctuation"},"("),o.a.createElement("br",null),"    newPayload",o.a.createElement("span",{className:"token operator"},"?"),o.a.createElement("span",{className:"token punctuation"},":"),o.a.createElement("br",null),"      ",o.a.createElement("span",{className:"token operator"},"|")," ",o.a.createElement("span",{className:"token maybe-class-name"},"Payload"),o.a.createElement("br",null),"      ",o.a.createElement("span",{className:"token operator"},"|")," ",o.a.createElement("span",{className:"token maybe-class-name"},"React"),o.a.createElement("span",{className:"token punctuation"},"."),o.a.createElement("span",{className:"token property-access"},o.a.createElement("span",{className:"token maybe-class-name"},"SyntheticEvent")),o.a.createElement("br",null),"      ",o.a.createElement("span",{className:"token operator"},"|")," undefined ",o.a.createElement("span",{className:"token comment"},"/* SyntheticEvent\u662f\u4e3a\u4e86\u76f4\u63a5\u5c06send\u7ed1\u5b9a\u7ed9onClick\u7b49\u65f6\u4e0d\u51fa\u73b0\u7c7b\u578b\u9519\u8bef */"),o.a.createElement("br",null),"  ",o.a.createElement("span",{className:"token punctuation"},")")," ",o.a.createElement("span",{className:"token arrow operator"},"=>")," ",o.a.createElement("span",{className:"token known-class-name class-name"},"Promise"),o.a.createElement("span",{className:"token operator"},"<"),o.a.createElement("span",{className:"token punctuation"},"["),o.a.createElement("span",{className:"token builtin"},"any"),o.a.createElement("span",{className:"token punctuation"},",")," ",o.a.createElement("span",{className:"token maybe-class-name"},"Data"),o.a.createElement("span",{className:"token punctuation"},"]"),o.a.createElement("span",{className:"token operator"},">"),o.a.createElement("span",{className:"token punctuation"},";"),o.a.createElement("br",null),o.a.createElement("span",{className:"token punctuation"},"}"),o.a.createElement("br",null)))))}},xQ7e:function(n,a,s){"use strict";s.d(a,"a",(function(){return d}));var t=s("tJVT"),p=s("k1fw"),e=s("K3qG"),o=s("q1tI"),c=s("2dX0"),l="USE_STORAGE_CACHE",u={local:e["a"].localStorage,session:e["a"].sessionStorage};function r(n,a){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"session";if(void 0!==a){var t=u[s];t&&t.setItem("".concat(l,"_").concat(n.toUpperCase()),JSON.stringify(a))}}function k(n){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"session",s=u[a];if(s){var t=s.getItem("".concat(l,"_").concat(n.toUpperCase()));return null===t?t:JSON.parse(t)}}function i(n){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"session",s=u[a];s&&s.removeItem("".concat(l,"_").concat(n.toUpperCase()))}var m={type:"session",disabled:!1};function g(n,a,s){var e=Object(p["a"])({},m,{},s),l=Object(o["useState"])(()=>{if(!e.disabled){var s=k(n,e.type);if(null!==s)return s}if(a instanceof Function){var t=a();return!e.disabled&&r(n,t,e.type),t}return!e.disabled&&r(n,a,e.type),a}),u=Object(t["a"])(l,2),i=u[0],g=u[1],d=Object(c["a"])(a=>{a instanceof Function?g(s=>{var t=a(s);return!e.disabled&&r(n,t,e.type),t}):(!e.disabled&&r(n,a,e.type),g(a))});return[i,d]}var d=Object.assign(g,{get:k,set:r,remove:i})}}]);