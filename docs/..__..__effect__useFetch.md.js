(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[14,13],{"0Owb":function(n,a,s){"use strict";function t(){return t=Object.assign||function(n){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var t in s)Object.prototype.hasOwnProperty.call(s,t)&&(n[t]=s[t])}return n},t.apply(this,arguments)}s.d(a,"a",(function(){return t}))},"2dX0":function(n,a,s){"use strict";s.d(a,"a",(function(){return e}));var t=s("q1tI");function e(n,a){var s=Object(t["useRef"])(()=>{throw new Error("Cannot call function while rendering")});s.current=n;var e=Object(t["useMemo"])(()=>{var n=function(){return s.current(...arguments)};return a?a(n):n},[]),p=Object(t["useCallback"])(e,[s]);return p}},"4H9c":function(n,a,s){"use strict";s.d(a,"a",(function(){return p}));var t=s("tJVT"),e=s("q1tI"),p=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=Object(e["useState"])(0),s=Object(t["a"])(a,2),p=s[1],o=Object(e["useState"])(n),c=Object(t["a"])(o,2),l=c[0],u=c[1],r=Object(e["useCallback"])(n=>{u(Object.assign(l,n instanceof Function?n(l):n)),p(n=>n+1)},[u]);return[l,r]}},FsCC:function(n,a,s){"use strict";s.r(a);var t=s("tJVT"),e=s("q1tI"),p=s.n(e),o=s("WmNS"),c=s.n(o),l=s("k1fw"),u=s("9og8"),r=s("K3qG"),i=s("sEfC"),k=s.n(i),m=s("DzJC"),d=s.n(m),E=s("hEdC"),g=s("W3VL"),b=s("4H9c"),N=s("xQ7e"),f=s("2dX0"),v=r["a"];function y(n){return!!n&&!!(Object(r["h"])(n)&&"nativeEvent"in n&&"target"in n&&"type"in n)}function h(n){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=Object(g["a"])({fetchID:0,fetchCount:0,timeoutTimer:0,lastFetch:Date.now()}),p=a.initData,o=a.initPayload,i=a.deps,m=void 0===i?[]:i,h=a.arg,x=a.manual,w=void 0!==x&&x,C=a.timeout,j=void 0===C?1e4:C,O=a.onSuccess,S=a.onError,F=a.onComplete,D=a.onTimeout,P=a.cacheKey,I=a.stale,T=void 0===I||I,_=a.throttleInterval,J=a.debounceInterval,M=a.pollingInterval,U=!!P,q=Object(b["a"])({loading:!w&&Object(r["f"])(n),error:void 0,timeout:!1}),A=Object(t["a"])(q,2),K=A[0],R=A[1];Object(e["useEffect"])(()=>()=>{s.fetchID=0,s.timeoutTimer&&v.clearTimeout(s.timeoutTimer)},[]);var H=Object(N["a"])("".concat(P,"_FETCH_PAYLOAD"),o,{disabled:!U}),V=Object(t["a"])(H,2),G=V[0],L=V[1],W=Object(N["a"])("".concat(P,"_FETCH_DATA"),p,{disabled:!U}),X=Object(t["a"])(W,2),B=X[0],Q=X[1],Y=Object(N["a"])("".concat(P,"_FETCH_ARG"),h,{disabled:!U}),z=Object(t["a"])(Y,2),Z=z[0],$=z[1],nn=Object(e["useState"])(!0),an=Object(t["a"])(nn,2),sn=an[0],tn=an[1];Object(E["a"])(()=>{$(h)},[h]);var en=Object(f["a"])(function(){var a=Object(u["a"])(c.a.mark((function a(t){var e,p,o,u,i,k=arguments;return c.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e=k.length>1&&void 0!==k[1]&&k[1],p=Object(r["f"])(n),p){a.next=4;break}return a.abrupt("return");case 4:return s.lastFetch=Date.now(),o=Math.random(),s.fetchID=o,s.timeoutTimer&&v.clearTimeout(s.timeoutTimer),s.timeoutTimer=v.setTimeout(()=>{ln(),null===D||void 0===D||D(),R(Object(l["a"])({},cn("timeout",!0)))},j),u=s.timeoutTimer,K.loading||R(Object(l["a"])({},cn("loading",!0))),a.prev=11,a.next=14,n(t);case 14:if(i=a.sent,o===s.fetchID){a.next=17;break}return a.abrupt("return");case 17:return R(Object(l["a"])({},cn("loading",!1))),Q(i),null===O||void 0===O||O(i,e),a.abrupt("return",[void 0,i]);case 23:if(a.prev=23,a.t0=a["catch"](11),o===s.fetchID){a.next=27;break}return a.abrupt("return");case 27:return R(Object(l["a"])({},cn("error",a.t0))),null===S||void 0===S||S(a.t0),a.abrupt("return",[a.t0,void 0]);case 30:if(a.prev=30,u&&v.clearTimeout(u),o===s.fetchID){a.next=34;break}return a.abrupt("return");case 34:return null===F||void 0===F||F(),s.fetchCount++,a.finish(30);case 37:case"end":return a.stop()}}),a,null,[[11,23,30,37]])})));function t(n){return a.apply(this,arguments)}return t}(),n=>_?d()(n,_,{trailing:!1}):J?k()(n,J):n),pn=Object(f["a"])(n=>{var a=y(n)||void 0===n;return en(on(n),a)});function on(n){return"arg"in a?h:y(n)||void 0===n?G:(L(n),n)}function cn(n,a){var s={loading:!1,error:void 0,timeout:!1};return n&&(s[n]=a),s}function ln(){s.fetchID=0,s.timeoutTimer&&v.clearTimeout(s.timeoutTimer),R({loading:!1})}return Object(e["useEffect"])(()=>{w||(T||0!==s.fetchCount||Object(r["e"])(B)?en(on(),0!==s.fetchCount):R({loading:!1}))},[Z,...m]),Object(e["useEffect"])((function(){var n;return sn&&M&&M>500&&(n=v.setInterval(()=>{var n=Date.now(),a=s.lastFetch,t=n-a>=M;t&&pn()},M)),()=>{n&&clearInterval(n)}}),[M,sn]),Object(l["a"])({},K,{send:pn,data:B,payload:G,arg:Z,setData:Q,cancel:ln,polling:sn,setPolling:tn})}function x(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1500,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2?arguments[2]:void 0;return function(){for(var t=arguments.length,e=new Array(t),p=0;p<t;p++)e[p]=arguments[p];return console.log(e,11),new Promise((t,e)=>{setTimeout(()=>{a?t(s||n):e(s||n)},n)})}}var w=()=>{var n=Object(e["useState"])(0),a=Object(t["a"])(n,2),s=a[0],o=a[1],c=h(x(1e3,!0,{name:"lxj",age:Math.random()}),{initData:{},cacheKey:"use_fetch_demo"}),l=c.send,u=c.data,r=c.payload,i=c.loading,k=c.error,m=c.timeout,d=c.cancel,E=c.arg;function g(){l(Math.random()).then(n=>{var a=Object(t["a"])(n,2),s=a[0],e=a[1];return console.log("resolve",[s,e])}).finally(()=>console.log("finally"))}return p.a.createElement("div",null,p.a.createElement("div",null,"useFetchDemo"),p.a.createElement("button",{onClick:l},"send"),p.a.createElement("button",{onClick:()=>l(Math.random())},"send by newPayload"),p.a.createElement("button",{onClick:()=>o(n=>n+1)},"change deps ",s),p.a.createElement("button",{onClick:d},"cancel"),p.a.createElement("button",{onClick:g},"sendPromise"),p.a.createElement("div",null,"data: ",JSON.stringify(u)),p.a.createElement("div",null,"payload: ",JSON.stringify(r)),p.a.createElement("div",null,"loading: ",i.toString()),p.a.createElement("div",null,"error: ",JSON.stringify(k)),p.a.createElement("div",null,"timeout: ",m.toString()),p.a.createElement("div",null,"arg: ",E))};a["default"]=w},W3VL:function(n,a,s){"use strict";s.d(a,"a",(function(){return e}));var t=s("q1tI");function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=Object(t["useRef"])(n);return a.current}},wTlT:function(n,a,s){"use strict";s.r(a);var t=s("0Owb"),e=s("q1tI"),p=s.n(e),o=(s("B2uJ"),s("5Yjd")),c=s.n(o),l=p.a.memo((function(){var n=t(s("q1tI")),a=t(s("FsCC"));function t(n){return n&&n.__esModule?n:{default:n}}var e=function(){return n["default"].createElement(a["default"],null)};return n["default"].createElement(e)}));a["default"]=function(){return p.a.createElement(p.a.Fragment,null,p.a.createElement("div",{className:"markdown"},p.a.createElement("h1",{id:"usefetch"},p.a.createElement("a",{"aria-hidden":"true",href:"#usefetch"},p.a.createElement("span",{className:"icon icon-link"})),"useFetch"),p.a.createElement("p",null,"\u901a\u8fc7\u66f4",p.a.createElement("code",null,"hook"),"\u7684\u65b9\u5f0f\u5bf9\u6570\u636e\u8bf7\u6c42\u72b6\u6001\u8fdb\u884c\u7ba1\u7406"),p.a.createElement("h2",{id:"\u793a\u4f8b"},p.a.createElement("a",{"aria-hidden":"true",href:"#\u793a\u4f8b"},p.a.createElement("span",{className:"icon icon-link"})),"\u793a\u4f8b")),p.a.createElement(c.a,Object(t["a"])({source:{raw:"import React, { useState } from 'react';\r\nimport { useFetch } from './useFetch';\r\n\r\nfunction mockFn(delay = 1500, isSuccess = false, res?: any) {\r\n  return function(...arg: any) {\r\n    console.log(arg, 11);\r\n\r\n    return new Promise((resolve, reject) => {\r\n      setTimeout(() => {\r\n        isSuccess ? resolve(res || delay) : reject(res || delay);\r\n      }, delay);\r\n    });\r\n  };\r\n}\r\n\r\nconst useFetchDemo = () => {\r\n  const [count, setCount] = useState(0);\r\n\r\n  const {\r\n    send,\r\n    data,\r\n    payload,\r\n    loading,\r\n    error,\r\n    timeout,\r\n    cancel,\r\n    arg,\r\n  } = useFetch(mockFn(1000, true, { name: 'lxj', age: Math.random() }), {\r\n    // deps: [count],\r\n    // arg: count,\r\n    initData: {},\r\n    // manual: true,\r\n    // stale: false,\r\n    cacheKey: 'use_fetch_demo',\r\n    // debounceInterval: 2000,\r\n    // pollingInterval: 2000,\r\n    // onSuccess(data, isUpdate) {\r\n    //   console.log(data, isUpdate);\r\n    // },\r\n    // onError(err) {\r\n    //   console.log('onError', err);\r\n    // },\r\n    // onComplete() {\r\n    //   console.log('onComplete');\r\n    // },\r\n  });\r\n\r\n  function sendPromise() {\r\n    send(Math.random())\r\n      .then(([err, res]) => console.log('resolve', [err, res]))\r\n      .finally(() => console.log('finally'));\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <div>useFetchDemo</div>\r\n      <button onClick={send}>send</button>\r\n      <button onClick={() => send(Math.random())}>send by newPayload</button>\r\n      <button onClick={() => setCount(prev => prev + 1)}>\r\n        change deps {count}\r\n      </button>\r\n      <button onClick={cancel}>cancel</button>\r\n      <button onClick={sendPromise}>sendPromise</button>\r\n      <div>data: {JSON.stringify(data)}</div>\r\n      <div>payload: {JSON.stringify(payload)}</div>\r\n      <div>loading: {loading.toString()}</div>\r\n      <div>error: {JSON.stringify(error)}</div>\r\n      <div>timeout: {timeout.toString()}</div>\r\n      <div>arg: {arg}</div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default useFetchDemo;\r\n",jsx:'<pre class="language-jsx"><code class="language-jsx"><span class="token keyword module">import</span> <span class="token maybe-class-name">React</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword module">from</span> <span class="token string">\'react\'</span><span class="token punctuation">;</span>\r\n<span class="token keyword module">import</span> <span class="token punctuation">{</span> useFetch <span class="token punctuation">}</span> <span class="token keyword module">from</span> <span class="token string">\'./useFetch\'</span><span class="token punctuation">;</span>\r\n\r\n<span class="token keyword">function</span> <span class="token function">mockFn</span><span class="token punctuation">(</span><span class="token parameter">delay <span class="token operator">=</span> <span class="token number">1500</span><span class="token punctuation">,</span> isSuccess <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\r\n  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token spread operator">...</span>arg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\r\n    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>arg<span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>\r\n      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>\r\n        isSuccess <span class="token operator">?</span> <span class="token function">resolve</span><span class="token punctuation">(</span>res <span class="token operator">||</span> delay<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">reject</span><span class="token punctuation">(</span>res <span class="token operator">||</span> delay<span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n      <span class="token punctuation">}</span><span class="token punctuation">,</span> delay<span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\r\n<span class="token punctuation">}</span>\r\n\r\n<span class="token keyword">const</span> <span class="token function-variable function">useFetchDemo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>\r\n  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n  <span class="token keyword">const</span> <span class="token punctuation">{</span> send<span class="token punctuation">,</span> data<span class="token punctuation">,</span> payload<span class="token punctuation">,</span> loading<span class="token punctuation">,</span> error<span class="token punctuation">,</span> timeout<span class="token punctuation">,</span> cancel<span class="token punctuation">,</span> arg <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useFetch</span><span class="token punctuation">(</span>\r\n    <span class="token function">mockFn</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>\r\n      name<span class="token punctuation">:</span> <span class="token string">\'lxj\'</span><span class="token punctuation">,</span>\r\n      age<span class="token punctuation">:</span> <span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\r\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\r\n    <span class="token punctuation">{</span>\r\n      <span class="token comment">// deps: [count],</span>\r\n      <span class="token comment">// arg: count,</span>\r\n      initData<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>\r\n      <span class="token comment">// manual: true,</span>\r\n      <span class="token comment">// stale: false,</span>\r\n      cacheKey<span class="token punctuation">:</span> <span class="token string">\'use_fetch_demo\'</span><span class="token punctuation">,</span> <span class="token comment">// debounceInterval: 2000,</span>\r\n      <span class="token comment">// pollingInterval: 2000,</span>\r\n      <span class="token comment">// onSuccess(data, isUpdate) {</span>\r\n      <span class="token comment">//   console.log(data, isUpdate);</span>\r\n      <span class="token comment">// },</span>\r\n      <span class="token comment">// onError(err) {</span>\r\n      <span class="token comment">//   console.log(\'onError\', err);</span>\r\n      <span class="token comment">// },</span>\r\n      <span class="token comment">// onComplete() {</span>\r\n      <span class="token comment">//   console.log(\'onComplete\');</span>\r\n      <span class="token comment">// },</span>\r\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\r\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n\r\n  <span class="token keyword">function</span> <span class="token function">sendPromise</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\r\n    <span class="token function">send</span><span class="token punctuation">(</span><span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\r\n      <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>err<span class="token punctuation">,</span> res<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">\'resolve\'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>err<span class="token punctuation">,</span> res<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\r\n      <span class="token punctuation">.</span><span class="token method function property-access">finally</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">\'finally\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n  <span class="token punctuation">}</span>\r\n\r\n  <span class="token keyword">return</span> <span class="token punctuation">(</span>\r\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">useFetchDemo</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>send<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">send</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">send by newPayload</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setCount</span><span class="token punctuation">(</span><span class="token parameter">prev</span> <span class="token arrow operator">=></span> prev <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">change deps </span><span class="token punctuation">{</span>count<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>cancel<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">cancel</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>sendPromise<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">sendPromise</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">data: </span><span class="token punctuation">{</span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">payload: </span><span class="token punctuation">{</span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">loading: </span><span class="token punctuation">{</span>loading<span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">error: </span><span class="token punctuation">{</span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">timeout: </span><span class="token punctuation">{</span>timeout<span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">arg: </span><span class="token punctuation">{</span>arg<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span>\r\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\r\n\r\n<span class="token keyword module">export</span> <span class="token keyword module">default</span> useFetchDemo<span class="token punctuation">;</span>\r\n\n</code></pre>',tsx:'<pre class="language-tsx"><code class="language-tsx"><span class="token keyword">import</span> <span class="token maybe-class-name">React</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'react\'</span><span class="token punctuation">;</span>\r\n<span class="token keyword">import</span> <span class="token punctuation">{</span> useFetch <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'./useFetch\'</span><span class="token punctuation">;</span>\r\n\r\n<span class="token keyword">function</span> <span class="token function">mockFn</span><span class="token punctuation">(</span><span class="token parameter">delay <span class="token operator">=</span> <span class="token number">1500</span><span class="token punctuation">,</span> isSuccess <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span> res<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\r\n  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token spread operator">...</span>arg<span class="token punctuation">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\r\n    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>arg<span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n\r\n    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>\r\n      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>\r\n        isSuccess <span class="token operator">?</span> <span class="token function">resolve</span><span class="token punctuation">(</span>res <span class="token operator">||</span> delay<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">reject</span><span class="token punctuation">(</span>res <span class="token operator">||</span> delay<span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n      <span class="token punctuation">}</span><span class="token punctuation">,</span> delay<span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\r\n<span class="token punctuation">}</span>\r\n\r\n<span class="token keyword">const</span> <span class="token function-variable function">useFetchDemo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>\r\n  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n\r\n  <span class="token keyword">const</span> <span class="token punctuation">{</span>\r\n    send<span class="token punctuation">,</span>\r\n    data<span class="token punctuation">,</span>\r\n    payload<span class="token punctuation">,</span>\r\n    loading<span class="token punctuation">,</span>\r\n    error<span class="token punctuation">,</span>\r\n    timeout<span class="token punctuation">,</span>\r\n    cancel<span class="token punctuation">,</span>\r\n    arg<span class="token punctuation">,</span>\r\n  <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useFetch</span><span class="token punctuation">(</span><span class="token function">mockFn</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">\'lxj\'</span><span class="token punctuation">,</span> age<span class="token punctuation">:</span> <span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>\r\n    <span class="token comment">// deps: [count],</span>\r\n    <span class="token comment">// arg: count,</span>\r\n    initData<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>\r\n    <span class="token comment">// manual: true,</span>\r\n    <span class="token comment">// stale: false,</span>\r\n    cacheKey<span class="token punctuation">:</span> <span class="token string">\'use_fetch_demo\'</span><span class="token punctuation">,</span>\r\n    <span class="token comment">// debounceInterval: 2000,</span>\r\n    <span class="token comment">// pollingInterval: 2000,</span>\r\n    <span class="token comment">// onSuccess(data, isUpdate) {</span>\r\n    <span class="token comment">//   console.log(data, isUpdate);</span>\r\n    <span class="token comment">// },</span>\r\n    <span class="token comment">// onError(err) {</span>\r\n    <span class="token comment">//   console.log(\'onError\', err);</span>\r\n    <span class="token comment">// },</span>\r\n    <span class="token comment">// onComplete() {</span>\r\n    <span class="token comment">//   console.log(\'onComplete\');</span>\r\n    <span class="token comment">// },</span>\r\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n\r\n  <span class="token keyword">function</span> <span class="token function">sendPromise</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\r\n    <span class="token function">send</span><span class="token punctuation">(</span><span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\r\n      <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>err<span class="token punctuation">,</span> res<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">\'resolve\'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>err<span class="token punctuation">,</span> res<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\r\n      <span class="token punctuation">.</span><span class="token keyword">finally</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">\'finally\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n  <span class="token punctuation">}</span>\r\n\r\n  <span class="token keyword">return</span> <span class="token punctuation">(</span>\r\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">useFetchDemo</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>send<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">send</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">send by newPayload</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setCount</span><span class="token punctuation">(</span><span class="token parameter">prev</span> <span class="token arrow operator">=></span> prev <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\r\n        change deps </span><span class="token punctuation">{</span>count<span class="token punctuation">}</span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>cancel<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">cancel</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>sendPromise<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">sendPromise</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">data: </span><span class="token punctuation">{</span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">payload: </span><span class="token punctuation">{</span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">loading: </span><span class="token punctuation">{</span>loading<span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">error: </span><span class="token punctuation">{</span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">timeout: </span><span class="token punctuation">{</span>timeout<span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">arg: </span><span class="token punctuation">{</span>arg<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\r\n    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span>\r\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\r\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\r\n\r\n<span class="token keyword">export</span> <span class="token keyword">default</span> useFetchDemo<span class="token punctuation">;</span>\r\n\n</code></pre>'}},{path:"/_demos/use-fetch.demo",dependencies:{}}),p.a.createElement(l,null)),p.a.createElement("div",{className:"markdown"},p.a.createElement("h2",{id:"\u5e38\u89c4\u8bf7\u6c42"},p.a.createElement("a",{"aria-hidden":"true",href:"#\u5e38\u89c4\u8bf7\u6c42"},p.a.createElement("span",{className:"icon icon-link"})),"\u5e38\u89c4\u8bf7\u6c42"),p.a.createElement("h2",{id:"api"},p.a.createElement("a",{"aria-hidden":"true",href:"#api"},p.a.createElement("span",{className:"icon icon-link"})),"API"),p.a.createElement("pre",{className:"language-ts"},p.a.createElement("code",{className:"language-ts"},p.a.createElement("span",{className:"token keyword"},"const")," bonus ",p.a.createElement("span",{className:"token operator"},"=")," ",p.a.createElement("span",{className:"token function"},"useFetch"),p.a.createElement("span",{className:"token punctuation"},"("),"method",p.a.createElement("span",{className:"token punctuation"},",")," options",p.a.createElement("span",{className:"token operator"},"?"),p.a.createElement("span",{className:"token punctuation"},")"),p.a.createElement("span",{className:"token punctuation"},";"),p.a.createElement("br",null))),p.a.createElement("p",null,p.a.createElement("strong",null,"method")," - \u4e00\u4e2a Promise return \u51fd\u6570\u6216 async \u51fd\u6570, \u5f53\u4e0d\u4e3a\u51fd\u6570\u65f6\u4e0d\u4f1a\u8d70\u8bf7\u6c42\u6d41\u7a0b, \u53ef\u85c9\u6b64\u5b9e\u73b0\u4e32\u8fde\u8bf7\u6c42"),p.a.createElement("p",null,p.a.createElement("strong",null,"options")," - \u914d\u7f6e"),p.a.createElement("pre",{className:"language-ts"},p.a.createElement("code",{className:"language-ts"},p.a.createElement("span",{className:"token maybe-class-name"},"UseFetchOptions"),p.a.createElement("span",{className:"token operator"},"<"),p.a.createElement("span",{className:"token maybe-class-name"},"Data"),p.a.createElement("span",{className:"token punctuation"},",")," ",p.a.createElement("span",{className:"token maybe-class-name"},"Payload"),p.a.createElement("span",{className:"token operator"},">")," ",p.a.createElement("span",{className:"token punctuation"},"{"),p.a.createElement("br",null)," ",p.a.createElement("span",{className:"token doc-comment comment"}," /** [] | \u7c7b\u4f3cuseEffect(fn, deps)\uff0c\u5f53\u4f9d\u8d56\u6570\u7ec4\u5185\u7684\u503c\u53d1\u751f\u6539\u53d8\u65f6\uff0c\u91cd\u65b0\u8fdb\u884c\u8bf7\u6c42 */"),p.a.createElement("br",null),"  deps",p.a.createElement("span",{className:"token operator"},"?"),p.a.createElement("span",{className:"token punctuation"},":")," ",p.a.createElement("span",{className:"token builtin"},"any"),p.a.createElement("span",{className:"token punctuation"},"["),p.a.createElement("span",{className:"token punctuation"},"]"),p.a.createElement("span",{className:"token punctuation"},";"),p.a.createElement("br",null)," ",p.a.createElement("span",{className:"token doc-comment comment"}," /** \u5f53\u67e5\u8be2\u65b9\u6cd5\u4f9d\u8d56\u7b80\u5355\u7c7b\u578b\u53c2\u6570\u65f6\u4f7f\u7528\uff0c\u5728\u53d8\u66f4\u65f6\u53d1\u8d77\u66f4\u65b0\u8bf7\u6c42\u5e76\u4f5c\u4e3a\u53c2\u6570\u4f20\u5165\u67e5\u8be2\u65b9\u6cd5\u3002\u4f20\u9012\u6b64\u9879\u65f6\uff0cPayload\u4f1a\u88ab\u5ffd\u7565 */"),p.a.createElement("br",null),"  arg",p.a.createElement("span",{className:"token operator"},"?"),p.a.createElement("span",{className:"token punctuation"},":")," ",p.a.createElement("span",{className:"token builtin"},"string")," ",p.a.createElement("span",{className:"token operator"},"|")," ",p.a.createElement("span",{className:"token builtin"},"number")," ",p.a.createElement("span",{className:"token operator"},"|")," ",p.a.createElement("span",{className:"token builtin"},"boolean"),p.a.createElement("span",{className:"token punctuation"},";"),p.a.createElement("br",null)," ",p.a.createElement("span",{className:"token doc-comment comment"}," /** false | \u53ea\u80fd\u901a\u8fc7send\u6765\u89e6\u53d1\u8bf7\u6c42 */"),p.a.createElement("br",null),"  manual",p.a.createElement("span",{className:"token operator"},"?"),p.a.createElement("span",{className:"token punctuation"},":")," ",p.a.createElement("span",{className:"token builtin"},"boolean"),p.a.createElement("span",{className:"token punctuation"},";"),p.a.createElement("br",null)," ",p.a.createElement("span",{className:"token doc-comment comment"}," /** 8000 | \u8d85\u65f6\u65f6\u95f4 */"),p.a.createElement("br",null),"  timeout",p.a.createElement("span",{className:"token operator"},"?"),p.a.createElement("span",{className:"token punctuation"},":")," ",p.a.createElement("span",{className:"token builtin"},"number"),p.a.createElement("span",{className:"token punctuation"},";"),p.a.createElement("br",null)," ",p.a.createElement("span",{className:"token doc-comment comment"}," /** \u521d\u59cbdata, \u652f\u6301 `T => T` \u65b9\u5f0f\u53d6\u503c */"),p.a.createElement("br",null),"  initData",p.a.createElement("span",{className:"token operator"},"?"),p.a.createElement("span",{className:"token punctuation"},":")," ",p.a.createElement("span",{className:"token punctuation"},"("),p.a.createElement("span",{className:"token punctuation"},"("),p.a.createElement("span",{className:"token punctuation"},")")," ",p.a.createElement("span",{className:"token arrow operator"},"=>")," ",p.a.createElement("span",{className:"token maybe-class-name"},"Data"),p.a.createElement("span",{className:"token punctuation"},")")," ",p.a.createElement("span",{className:"token operator"},"|")," ",p.a.createElement("span",{className:"token maybe-class-name"},"Data"),p.a.createElement("span",{className:"token punctuation"},";"),p.a.createElement("br",null)," ",p.a.createElement("span",{className:"token doc-comment comment"}," /** \u521d\u59cbpayload, \u652f\u6301 `T => T` \u65b9\u5f0f\u53d6\u503c */"),p.a.createElement("br",null),"  initPayload",p.a.createElement("span",{className:"token operator"},"?"),p.a.createElement("span",{className:"token punctuation"},":")," ",p.a.createElement("span",{className:"token punctuation"},"("),p.a.createElement("span",{className:"token punctuation"},"("),p.a.createElement("span",{className:"token punctuation"},")")," ",p.a.createElement("span",{className:"token arrow operator"},"=>")," ",p.a.createElement("span",{className:"token maybe-class-name"},"Payload"),p.a.createElement("span",{className:"token punctuation"},")")," ",p.a.createElement("span",{className:"token operator"},"|")," ",p.a.createElement("span",{className:"token maybe-class-name"},"Payload"),p.a.createElement("span",{className:"token punctuation"},";"),p.a.createElement("br",null)," ",p.a.createElement("span",{className:"token doc-comment comment"}," /** \u6210\u529f\u56de\u8c03, \u5f53\u4e3a\u66f4\u65b0\u8bf7\u6c42(\u901a\u8fc7\u65e0\u53c2\u8c03\u7528send, arg\uff0cdeps\u7b49\u914d\u7f6e\u53d1\u8d77\u8bf7\u6c42)\u65f6\uff0c\u6b64\u9879\u4e3atrue */"),p.a.createElement("br",null),"  onSuccess",p.a.createElement("span",{className:"token operator"},"?"),p.a.createElement("span",{className:"token punctuation"},":")," ",p.a.createElement("span",{className:"token punctuation"},"("),p.a.createElement("span",{className:"token parameter"},"result",p.a.createElement("span",{className:"token punctuation"},":")," ",p.a.createElement("span",{className:"token maybe-class-name"},"Data"),p.a.createElement("span",{className:"token punctuation"},",")," isUpdate",p.a.createElement("span",{className:"token punctuation"},":")," ",p.a.createElement("span",{className:"token builtin"},"boolean")),p.a.createElement("span",{className:"token punctuation"},")")," ",p.a.createElement("span",{className:"token arrow operator"},"=>")," ",p.a.createElement("span",{className:"token keyword"},"void"),p.a.createElement("span",{className:"token punctuation"},";"),p.a.createElement("br",null)," ",p.a.createElement("span",{className:"token doc-comment comment"}," /** \u9519\u8bef\u56de\u8c03\uff0c error\u4e3a\u8bf7\u6c42\u51fd\u6570\u4e2d\u629b\u51fa\u7684\u9519\u8bef */"),p.a.createElement("br",null),"  onError",p.a.createElement("span",{className:"token operator"},"?"),p.a.createElement("span",{className:"token punctuation"},":")," ",p.a.createElement("span",{className:"token punctuation"},"("),p.a.createElement("span",{className:"token parameter"},"error",p.a.createElement("span",{className:"token punctuation"},":")," ",p.a.createElement("span",{className:"token builtin"},"any")),p.a.createElement("span",{className:"token punctuation"},")")," ",p.a.createElement("span",{className:"token arrow operator"},"=>")," ",p.a.createElement("span",{className:"token keyword"},"void"),p.a.createElement("span",{className:"token punctuation"},";"),p.a.createElement("br",null)," ",p.a.createElement("span",{className:"token doc-comment comment"}," /** \u65e0\u8bba\u6210\u529f\u4e0e\u5426\u90fd\u4f1a\u8c03\u7528\u3002\u5728\u65e7\u7684\u8bf7\u6c42\u88ab\u65b0\u7684\u8bf7\u6c42\u8986\u76d6\u6389\u65f6\uff0c\u4e0d\u4f1a\u89e6\u53d1\u3002 */"),p.a.createElement("br",null),"  onComplete",p.a.createElement("span",{className:"token operator"},"?"),p.a.createElement("span",{className:"token punctuation"},":")," ",p.a.createElement("span",{className:"token punctuation"},"("),p.a.createElement("span",{className:"token punctuation"},")")," ",p.a.createElement("span",{className:"token arrow operator"},"=>")," ",p.a.createElement("span",{className:"token keyword"},"void"),p.a.createElement("span",{className:"token punctuation"},";"),p.a.createElement("br",null)," ",p.a.createElement("span",{className:"token doc-comment comment"}," /** \u8bf7\u6c42\u8d85\u65f6\u7684\u56de\u8c03 */"),p.a.createElement("br",null),"  onTimeout",p.a.createElement("span",{className:"token operator"},"?"),p.a.createElement("span",{className:"token punctuation"},":")," ",p.a.createElement("span",{className:"token punctuation"},"("),p.a.createElement("span",{className:"token punctuation"},")")," ",p.a.createElement("span",{className:"token arrow operator"},"=>")," ",p.a.createElement("span",{className:"token keyword"},"void"),p.a.createElement("span",{className:"token punctuation"},";"),p.a.createElement("br",null)," ",p.a.createElement("span",{className:"token doc-comment comment"}," /** \u7528\u4e8e\u7f13\u5b58\u7684key\uff0c\u4f20\u9012\u540e\uff0c\u4f1a\u5c06(payload, data, arg)\u7f13\u5b58\u5230session\u4e2d\uff0c\u4e0b\u6b21\u52a0\u8f7d\u65f6\u5c06\u8bfb\u53d6\u7f13\u5b58\u6570\u636e\u4f5c\u4e3a\u521d\u59cb\u503c */"),p.a.createElement("br",null),"  cacheKey",p.a.createElement("span",{className:"token operator"},"?"),p.a.createElement("span",{className:"token punctuation"},":")," ",p.a.createElement("span",{className:"token builtin"},"string"),p.a.createElement("span",{className:"token punctuation"},";"),p.a.createElement("br",null)," ",p.a.createElement("span",{className:"token doc-comment comment"}," /** true | \u5728\u5b58\u5728\u7f13\u5b58\u6570\u636e\u65f6\uff0c\u662f\u5426\u8fdb\u884cswr(stale-while-revalidate)\u8bf7\u6c42 */"),p.a.createElement("br",null),"  stale",p.a.createElement("span",{className:"token operator"},"?"),p.a.createElement("span",{className:"token punctuation"},":")," ",p.a.createElement("span",{className:"token builtin"},"boolean"),p.a.createElement("span",{className:"token punctuation"},";"),p.a.createElement("br",null)," ",p.a.createElement("span",{className:"token doc-comment comment"}," /** \u8282\u6d41\u65f6\u95f4\uff0c\u4f20\u5165\u65f6\uff0c\u5f00\u542f\u8282\u6d41, \u53ea\u6709\u521d\u59cb\u5316\u65f6\u7684\u914d\u7f6e\u4f1a\u751f\u6548 */"),p.a.createElement("br",null),"  throttleInterval",p.a.createElement("span",{className:"token operator"},"?"),p.a.createElement("span",{className:"token punctuation"},":")," ",p.a.createElement("span",{className:"token builtin"},"number"),p.a.createElement("span",{className:"token punctuation"},";"),p.a.createElement("br",null)," ",p.a.createElement("span",{className:"token doc-comment comment"}," /** \u8282\u6d41\u65f6\u95f4\uff0c\u4f20\u5165\u65f6\uff0c\u5f00\u542f\u9632\u6296, \u53ea\u6709\u521d\u59cb\u5316\u65f6\u7684\u914d\u7f6e\u4f1a\u751f\u6548, \u5f53\u5b58\u5728throttleInterval\u65f6\uff0c\u6b64\u914d\u7f6e\u4e0d\u4f1a\u751f\u6548 */"),p.a.createElement("br",null),"  debounceInterval",p.a.createElement("span",{className:"token operator"},"?"),p.a.createElement("span",{className:"token punctuation"},":")," ",p.a.createElement("span",{className:"token builtin"},"number"),p.a.createElement("span",{className:"token punctuation"},";"),p.a.createElement("br",null)," ",p.a.createElement("span",{className:"token doc-comment comment"}," /** \u8f6e\u8be2\u95f4\u9694, \u5927\u4e8e500\u65f6\u751f\u6548 */"),p.a.createElement("br",null),"  pollingInterval",p.a.createElement("span",{className:"token operator"},"?"),p.a.createElement("span",{className:"token punctuation"},":")," ",p.a.createElement("span",{className:"token builtin"},"number"),p.a.createElement("span",{className:"token punctuation"},";"),p.a.createElement("br",null),p.a.createElement("span",{className:"token punctuation"},"}"),p.a.createElement("br",null))),p.a.createElement("p",null,p.a.createElement("strong",null,"bonus")),p.a.createElement("pre",{className:"language-ts"},p.a.createElement("code",{className:"language-ts"},p.a.createElement("span",{className:"token maybe-class-name"},"UseFetchReturns"),p.a.createElement("span",{className:"token operator"},"<"),p.a.createElement("span",{className:"token maybe-class-name"},"Data"),p.a.createElement("span",{className:"token punctuation"},",")," ",p.a.createElement("span",{className:"token maybe-class-name"},"Payload"),p.a.createElement("span",{className:"token operator"},">")," ",p.a.createElement("span",{className:"token punctuation"},"{"),p.a.createElement("br",null)," ",p.a.createElement("span",{className:"token doc-comment comment"}," /** \u662f\u5426\u6b63\u5728\u8bf7\u6c42 */"),p.a.createElement("br",null),"  loading",p.a.createElement("span",{className:"token punctuation"},":")," ",p.a.createElement("span",{className:"token builtin"},"boolean"),p.a.createElement("span",{className:"token punctuation"},";"),p.a.createElement("br",null)," ",p.a.createElement("span",{className:"token doc-comment comment"}," /** method\u65b9\u6cd5reject\u65f6\uff0cerror\u4e3a\u5b83reject\u7684\u503c\u3002 */"),p.a.createElement("br",null),"  error",p.a.createElement("span",{className:"token punctuation"},":")," ",p.a.createElement("span",{className:"token builtin"},"any"),p.a.createElement("span",{className:"token punctuation"},";"),p.a.createElement("br",null)," ",p.a.createElement("span",{className:"token doc-comment comment"}," /** \u8bf7\u6c42\u8d85\u65f6\u8bbe\u7f6e\u4e3atrue */"),p.a.createElement("br",null),"  timeout",p.a.createElement("span",{className:"token punctuation"},":")," ",p.a.createElement("span",{className:"token builtin"},"boolean"),p.a.createElement("span",{className:"token punctuation"},";"),p.a.createElement("br",null)," ",p.a.createElement("span",{className:"token doc-comment comment"}," /** method\u65b9\u6cd5resolve\u7684\u503c\u6216initData */"),p.a.createElement("br",null),"  data",p.a.createElement("span",{className:"token punctuation"},":")," ",p.a.createElement("span",{className:"token maybe-class-name"},"Data")," ",p.a.createElement("span",{className:"token operator"},"|")," undefined",p.a.createElement("span",{className:"token punctuation"},";"),p.a.createElement("br",null)," ",p.a.createElement("span",{className:"token doc-comment comment"}," /** \u5f53\u524d\u7528\u4e8e\u8bf7\u6c42\u7684payload */"),p.a.createElement("br",null),"  payload",p.a.createElement("span",{className:"token punctuation"},":")," ",p.a.createElement("span",{className:"token maybe-class-name"},"Payload")," ",p.a.createElement("span",{className:"token operator"},"|")," undefined",p.a.createElement("span",{className:"token punctuation"},";"),p.a.createElement("br",null)," ",p.a.createElement("span",{className:"token doc-comment comment"}," /** \u8bf7\u6c42\u51fd\u6570\u4f9d\u8d56\u7684\u53c2\u6570\uff0c\u4e00\u822c\u4ee3\u66ffpayload\u4f7f\u7528 */"),p.a.createElement("br",null),"  arg",p.a.createElement("span",{className:"token punctuation"},":")," ",p.a.createElement("span",{className:"token builtin"},"string")," ",p.a.createElement("span",{className:"token operator"},"|")," ",p.a.createElement("span",{className:"token builtin"},"number")," ",p.a.createElement("span",{className:"token operator"},"|")," ",p.a.createElement("span",{className:"token builtin"},"boolean")," ",p.a.createElement("span",{className:"token operator"},"|")," undefined",p.a.createElement("span",{className:"token punctuation"},";"),p.a.createElement("br",null)," ",p.a.createElement("span",{className:"token doc-comment comment"}," /** \u8bbe\u7f6e\u5f53\u524d\u7684data */"),p.a.createElement("br",null),"  setData",p.a.createElement("span",{className:"token punctuation"},":")," ",p.a.createElement("span",{className:"token maybe-class-name"},"SetStateBase"),p.a.createElement("span",{className:"token operator"},"<"),p.a.createElement("span",{className:"token maybe-class-name"},"Data"),p.a.createElement("span",{className:"token operator"},">"),p.a.createElement("span",{className:"token punctuation"},";"),p.a.createElement("br",null)," ",p.a.createElement("span",{className:"token doc-comment comment"}," /** \u53d6\u6d88\u8bf7\u6c42 */"),p.a.createElement("br",null),"  ",p.a.createElement("span",{className:"token function-variable function"},"cancel"),p.a.createElement("span",{className:"token punctuation"},":")," ",p.a.createElement("span",{className:"token punctuation"},"("),p.a.createElement("span",{className:"token punctuation"},")")," ",p.a.createElement("span",{className:"token arrow operator"},"=>")," ",p.a.createElement("span",{className:"token keyword"},"void"),p.a.createElement("span",{className:"token punctuation"},";"),p.a.createElement("br",null)," ",p.a.createElement("span",{className:"token doc-comment comment"}," /** \u8f6e\u8be2\u7684\u5f00\u5173\u72b6\u6001\uff0c\u8f6e\u8be2\u8fd8\u4f9d\u8d56\u4e8epollingInterval\u914d\u7f6e\uff0c\u53ea\u6709\u4e24\u8005\u540c\u65f6\u6709\u6548\u65f6\u624d\u4f1a\u5f00\u542f\u8f6e\u8be2 */"),p.a.createElement("br",null),"  polling",p.a.createElement("span",{className:"token punctuation"},":")," ",p.a.createElement("span",{className:"token builtin"},"boolean"),p.a.createElement("span",{className:"token punctuation"},";"),p.a.createElement("br",null)," ",p.a.createElement("span",{className:"token doc-comment comment"}," /** \u8bbe\u7f6e\u8f6e\u8be2\u5f00\u5173\u72b6\u6001 */"),p.a.createElement("br",null),"  setPolling",p.a.createElement("span",{className:"token punctuation"},":")," ",p.a.createElement("span",{className:"token punctuation"},"("),p.a.createElement("span",{className:"token punctuation"},"("),p.a.createElement("span",{className:"token parameter"},"prev",p.a.createElement("span",{className:"token punctuation"},":")," ",p.a.createElement("span",{className:"token builtin"},"boolean")),p.a.createElement("span",{className:"token punctuation"},")")," ",p.a.createElement("span",{className:"token arrow operator"},"=>")," ",p.a.createElement("span",{className:"token builtin"},"boolean"),p.a.createElement("span",{className:"token punctuation"},")")," ",p.a.createElement("span",{className:"token operator"},"|")," ",p.a.createElement("span",{className:"token builtin"},"boolean"),p.a.createElement("span",{className:"token punctuation"},";"),p.a.createElement("br",null)," ",p.a.createElement("span",{className:"token doc-comment comment"}," /** \u4ee5\u65b0\u53c2\u6570\u53d1\u8d77\u8bf7\u6c42/\u53d1\u8d77\u66f4\u65b0(\u65e0\u53c2\u6570)/\u5b58\u5728arg\u65f6\u4f1a\u4ee5arg\u4ee3\u66ffpayload, \u5982\u679c\u8be5\u6b21\u8bf7\u6c42\u6709\u6548\uff0c\u8fd4\u56de\u4e00\u4e2a\u5fc5\u5b9aresolve\u6570\u7ec4\u7684Promise\uff0c\u6570\u7ec4\u503c1\u4e3a\u6267\u884c\u9519\u8bef\uff0c\u6570\u7ec4\u503c2\u4e3a\u8bf7\u6c42\u7ed3\u679c */"),p.a.createElement("br",null),"  ",p.a.createElement("span",{className:"token function-variable function"},"send"),p.a.createElement("span",{className:"token punctuation"},":")," ",p.a.createElement("span",{className:"token punctuation"},"("),p.a.createElement("span",{className:"token parameter"},"newPayload",p.a.createElement("span",{className:"token operator"},"?"),p.a.createElement("span",{className:"token punctuation"},":")," ",p.a.createElement("span",{className:"token maybe-class-name"},"Payload")," ",p.a.createElement("span",{className:"token operator"},"|")," undefined"),p.a.createElement("span",{className:"token punctuation"},")")," ",p.a.createElement("span",{className:"token arrow operator"},"=>")," ",p.a.createElement("span",{className:"token known-class-name class-name"},"Promise"),p.a.createElement("span",{className:"token operator"},"<"),p.a.createElement("span",{className:"token punctuation"},"["),p.a.createElement("span",{className:"token builtin"},"any"),p.a.createElement("span",{className:"token punctuation"},",")," ",p.a.createElement("span",{className:"token maybe-class-name"},"Data"),p.a.createElement("span",{className:"token punctuation"},"]"),p.a.createElement("span",{className:"token operator"},">"),p.a.createElement("span",{className:"token punctuation"},";"),p.a.createElement("br",null),p.a.createElement("span",{className:"token punctuation"},"}"),p.a.createElement("br",null)))))}},xQ7e:function(n,a,s){"use strict";s.d(a,"a",(function(){return E}));var t=s("tJVT"),e=s("k1fw"),p=s("K3qG"),o=s("q1tI"),c=s("2dX0"),l="USE_STORAGE_CACHE",u={local:p["a"].localStorage,session:p["a"].sessionStorage};function r(n,a){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"session";if(void 0!==a){var t=u[s];t&&t.setItem("".concat(l,"_").concat(n.toUpperCase()),JSON.stringify(a))}}function i(n){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"session",s=u[a];if(s){var t=s.getItem("".concat(l,"_").concat(n.toUpperCase()));return null===t?t:JSON.parse(t)}}function k(n){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"session",s=u[a];s&&s.removeItem("".concat(l,"_").concat(n.toUpperCase()))}var m={type:"session",disabled:!1};function d(n,a,s){var p=Object(e["a"])({},m,{},s),l=Object(o["useState"])(()=>{if(!p.disabled){var s=i(n,p.type);if(null!==s)return s}if(a instanceof Function){var t=a();return!p.disabled&&r(n,t,p.type),t}return!p.disabled&&r(n,a,p.type),a}),u=Object(t["a"])(l,2),k=u[0],d=u[1],E=Object(c["a"])(a=>{a instanceof Function?d(s=>{var t=a(s);return!p.disabled&&r(n,t,p.type),t}):(!p.disabled&&r(n,a,p.type),d(a))});return[k,E]}var E=Object.assign(d,{get:i,set:r,remove:k})}}]);